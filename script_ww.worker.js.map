{"version":3,"sources":["webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/construct.js","webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/slicedToArray.js","webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://trading-vue-js/./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack://trading-vue-js/./node_modules/@babel/runtime/regenerator/index.js","webpack://trading-vue-js/./node_modules/arrayslicer/lib/compare/index.js","webpack://trading-vue-js/./node_modules/arrayslicer/lib/index.js","webpack://trading-vue-js/./node_modules/arrayslicer/lib/search/binary.js","webpack://trading-vue-js/./node_modules/arrayslicer/lib/util.js","webpack://trading-vue-js/./src/helpers/dataset.js","webpack://trading-vue-js/./src/helpers/sampler.js","webpack://trading-vue-js/./src/helpers/script_engine.js","webpack://trading-vue-js/./src/helpers/script_env.js","webpack://trading-vue-js/./src/helpers/script_std.js","webpack://trading-vue-js/./src/helpers/script_ts.js","webpack://trading-vue-js/./src/helpers/script_utils.js","webpack://trading-vue-js/./src/helpers/symbol.js","webpack://trading-vue-js/./src/helpers/symstd.js","webpack://trading-vue-js/./src/stuff/constants.js","webpack://trading-vue-js/./src/stuff/linreg.js","webpack://trading-vue-js/./src/stuff/utils.js","webpack://trading-vue-js/./node_modules/regenerator-runtime/runtime.js","webpack://trading-vue-js/webpack/bootstrap","webpack://trading-vue-js/webpack/runtime/compat get default export","webpack://trading-vue-js/webpack/runtime/define property getters","webpack://trading-vue-js/webpack/runtime/hasOwnProperty shorthand","webpack://trading-vue-js/webpack/runtime/make namespace object","webpack://trading-vue-js/./src/helpers/script_ww.js"],"names":["Dataset","dc","desc","type","id","data","ww","just","proto","Object","getPrototypeOf","setPrototypeOf","defineProperty","get","exec","arr","del","dss","ds","n","p","nids","map","x","pids","includes","filter","remove","types","main","chart","base","find","ohlcv","DatasetWW","last_upd","now","Array","isArray","len","length","t0","tN","l","r","concat","se","op","recalc_size","merge","k","split","iN","last","dp","push","DEF_LIMIT","T","auto","Ti","indexOf","t","tf","__tf__","__id__","val","__t0__","unshift","__len__","WAIT_EXEC","ScriptEngine","exec_id","queue","delta_queue","update_queue","sett","state","mods","std_plus","undefined","clearTimeout","setTimeout","init_state","keys","re_init_map","shift","run","drain_queues","send_state","delta","sel","props","src","s","conf","init","init_src","u","update","upd_src","post","post_src","symstd","pre_env","uuid","env","ScriptEnv","assign","shared","open","high","low","close","vol","iter","range","onclose","tss","new_env","build","candles","running","mfs1","make_mods_hooks","mfs2","step","m","i","event","candle","limit","send_update","e","console","log","task","join","_restart","TS","skip","std","send","scripts","last_perf","perf","last_t","data_size","format_update","t1","Utils","pre_run_mods","start","restarted","custom_main","make_ohlcv","output","post_run_mods","format_map","__fn__","depth","script_depth","Math","max","exec_all","exec_sel","pop","c","res","f","t2","y","new_ovs","onchart","offchart","side","ids","pre_run","post_run","name","bind","all","values","reqs","unf","sym","tNext","sz","lim","ww_ram_limit","limit_size","toFixed","sort","a","b","FDEFS1","FDEFS2","ScriptStd","syms","box_maker","make_box","v","copy","out","ts","off","__offset__","point","getOwnPropertyNames","def","JSON","stringify","warn","Function","make_modules","prep","api","h","use_for","lastIndex","call_id","fkeyword","trim","fname","fargs","index","postfix","target","get_args","fdef","m0","parentheses","args","get_args_2","replace","str","count","first","substr","toString","reg","regex_clone","parts","q1","q2","q3","part","slice","rex","RegExp","source","flags","upd","fields","BUF_INC","SWMA","STDEV_EPS","STDEV_Z","_index_tracking","_add_i","src2","prev","next","_id","_tf","tstf","Sampler","isFinite","NaN","_tsid","x0","na","y0","abs","acos","cond","offset","sigma","floor","norm","sum","w","exp","pow","asin","atan","tfs","tr","rma","mult","basis","sma","dev","stdev","ma","cci","ceil","mom","change","g","sm1","sm2","num","cos","src1","nz","time","Date","getUTCDate","getUTCDay","mean","smooth","up","down","neg","plusDM","minusDM","trur","plus","div","minus","add","adx","ema","bot","Infinity","hi","len2","len3","round","sqrt","wma","delt","sub","getUTCHours","use_tr","kc","lr","linreg","log10","li","fast","slow","sig","fast_ma","slow_ma","macd","signal","hist","ch","ts1","ts2","upper","lower","rsi","min","getUTCMinutes","getUTCMonth","$synth","skipNaN","settings","grid","send_modify","getTime","left","right","top","pc","nc","inc","minTick","pos","maxMin","acc","outSet","getUTCSeconds","sign","sin","sumf","avg","sqd","lowest","highest","factor","atrlen","hl2","atr","ls","ls1","ss","ss1","dir","plot","Sym","data_type","TSS","ARR","NUM","tan","sesh","fixnan","short","long","m_abs","tsi","sxv","date","setUTCHours","setDate","week1","getUTCFullYear","hh","ll","FDEFS","SBRACKETS","TFSTR","tf_cache","f_args","f_body","lastIndexOf","wrap_idxs","pre","changed","vname","vindex","parseInt","wrap","make_module_lib","mod","lib","get_raw_src","tf_from_pair","pf","Const","tf_from_str","get_fn_id","ovf","obj","nw","nextt","ti","i0","mid","size_of_dss","bytes","s0","size_of","object","list","stack","value","OHLCV","params","format","aggtype","window","fillgaps","idx","data_idx","tmap","update_ohlcv","update_copy","update_custom","dt","noevent","ts0","tsn","forEach","SYMTF","FNSTD","SYMSTD","parse","parse_ts_sym","fn","deps","kcw","dmi","sar","supertrend","wpr","SECOND","MINUTE","MINUTE3","MINUTE5","MINUTE15","MINUTE30","HOUR","HOUR4","HOUR12","DAY","WEEK","MONTH","YEAR","MONTHMAP","TIMESCALES","$SCALES","ChartConfig","SBMIN","SBMAX","TOOLBAR","TB_ICON","TB_ITEM_M","TB_ICON_BRI","TB_ICON_HOLD","TB_BORDER","TB_B_STYLE","TOOL_COLL","EXPAND","CANDLEW","GRIDX","GRIDY","BOTBAR","PANHEIGHT","DEFAULT_LEN","MINIMUM_LEN","MIN_ZOOM","MAX_ZOOM","VOLSCALE","UX_OPACITY","ZOOM_MODE","L_BTN_SIZE","L_BTN_MARGIN","SCROLL_WHEEL","FONT","IB_TF_WARN","MAP_UNIT","map_unit","regression","reverse","sum_x","sum_y","sum_xy","sum_xx","clamp","add_zero","day_start","month_start","UTC","getFullYear","getMonth","year_start","get_year","get_month","nearest_a","array","dist","xi","decimals","parseFloat","strip","number","toPrecision","get_day","getDate","overwrite","new_arr","splice","copy_layout","new_obj","detect_interval","d","get_num_id","fast_filter","ia","IndexedArray","getRange","valpos","fast_filter_i","i1","i2","fast_nearest","fetch","nextlow","nexthigh","pause","delay","Promise","rs","rj","smart_wheel","get_deltaX","originalEvent","deltaX","get_deltaY","deltaY","apply_opacity","parse_tf","smth","index_shift","second","j","measureText","ctx","text","tv_id","measureTextOrg","width","doc","document","el","getElementById","createElement","style","position","appendChild","font","innerText","offsetWidth","temp","random","uuid2","is_scr_props_upd","$uuid","$props","some","delayed_exec","script","execInterval","$last_exec","format_name","ov","xmode","is_mobile","default_prevented","original","defaultPrevented","navigator","maxTouchPoints","msMaxTouchPoints","DocumentTouch"],"mappings":";;;;;;;;;;;;;;AAAe;AACf;;AAEA,wCAAwC,SAAS;AACjD;AACA;;AAEA;AACA,C;;;;;;;;;;;;;;;ACRe;AACf;AACA,C;;;;;;;;;;;;;;;;ACFqD;AACtC;AACf,iCAAiC,6DAAgB;AACjD,C;;;;;;;;;;;;;;;ACHA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEe;AACf;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA,C;;;;;;;;;;;;;;;AClCe;AACf;AACA;AACA;AACA,C;;;;;;;;;;;;;;;;;ACJiD;AACoB;AACtD;AACf,MAAM,qEAAwB;AAC9B;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,iBAAiB,2DAAc;AAC/B;AACA;AACA;;AAEA;AACA,C;;;;;;;;;;;;;;;ACjBA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEe;AACf;AACA;AACA;AACA,C;;;;;;;;;;;;;;;ACde;AACf;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;;AAEA;AACA,C;;;;;;;;;;;;;;;ACbe;AACf;AACA;AACA;;AAEA;AACA,gFAAgF;AAChF;AACA,GAAG;AACH;AACA;AACA,C;;;;;;;;;;;;;;;ACXe;AACf;AACA,C;;;;;;;;;;;;;;;ACFe;AACf;AACA;AACA;AACA;AACA;;AAEA;AACA,6CAA6C,+BAA+B;AAC5E;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA,C;;;;;;;;;;;;;;;ACzBe;AACf;AACA,C;;;;;;;;;;;;;;;ACFe;AACf;AACA,C;;;;;;;;;;;;;;;ACFe;AACf;AACA;AACA;AACA;;AAEA;AACA,C;;;;;;;;;;;;;;;;;;;ACPiD;AACY;AACY;AACtB;AACpC;AACf,SAAS,2DAAc,SAAS,iEAAoB,YAAY,uEAA0B,YAAY,4DAAe;AACrH,C;;;;;;;;;;;;;;;;;;;ACNuD;AACJ;AACsB;AAClB;AACxC;AACf,SAAS,8DAAiB,SAAS,4DAAe,SAAS,uEAA0B,SAAS,8DAAiB;AAC/G,C;;;;;;;;;;;;;;;ACNe;AACf;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA,C;;;;;;;;;;;;;;;;ACdqD;AACtC;AACf;AACA,oCAAoC,6DAAgB;AACpD;AACA;AACA;AACA,sFAAsF,6DAAgB;AACtG,C;;;;;;;;;;ACRA,gHAA+C;;;;;;;;;;;ACA/C;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,iBAAiB,OAAO;AACxB;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,eAAe,cAAc;AAC7B,eAAe,cAAc;AAC7B,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;;AAEA;;;;;;;;;;;AC5BA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,mBAAO,CAAC,sDAAQ;AAC3B,UAAU,mBAAO,CAAC,kEAAW;AAC7B,UAAU,mBAAO,CAAC,wEAAiB;;AAEnC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,uCAAuC;AACvC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,cAAc;AACzB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,cAAc;AACzB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;ACzNA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB;;;;;;;;;;;ACvDrB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA,qBAAqB;AACrB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA,qBAAqB;AACrB;;AAEA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrCA;AAEA;;IAEqBA,O;AAEjB,mBAAYC,EAAZ,EAAgBC,IAAhB,EAAsB;AAAA;;AAElB;AACA;AAEA,SAAKC,IAAL,GAAYD,IAAI,CAACC,IAAjB;AACA,SAAKC,EAAL,GAAUF,IAAI,CAACE,EAAf;AACA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AF,CAMN,OAAO9K,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,EANnC;AAlUA,CAAf,E;;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,aAAa;AACb,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,KAAK;AACL,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yDAAyD;AACzD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX;;AAEA;AACA;AACA,wCAAwC,WAAW;AACnD;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA2B;AAC3B;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,SAAS;AACT;AACA;AACA;AACA;;AAEA;;AAEA,SAAS;AACT;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oCAAoC,cAAc;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,iCAAiC,kBAAkB;AACnD;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,iBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAwB,iBAAiB;AACzC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;;AAEA;AACA,YAAY;AACZ;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,8CAA8C,QAAQ;AACtD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA,WAAW;AACX;AACA;AACA;;AAEA,WAAW;AACX;AACA;AACA;;AAEA,WAAW;AACX;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,8CAA8C,QAAQ;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA,KAAK;;AAEL;AACA,8CAA8C,QAAQ;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,8CAA8C,QAAQ;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,CAAC;AACD;AACA;AACA;AACA;AACA,EAAE,KAA0B,oBAAoB,CAAE;AAClD;;AAEA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;UC3uBA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCrBA;WACA;WACA;WACA;WACA;WACA,gCAAgC,YAAY;WAC5C;WACA,E;;;;;WCPA;WACA;WACA;WACA;WACA,wCAAwC,yCAAyC;WACjF;WACA;WACA,E;;;;;WCPA,wF;;;;;WCAA;WACA;WACA;WACA,sDAAsD,kBAAkB;WACxE;WACA,+CAA+C,cAAc;WAC7D,E;;;;;;;;;;;;;;;;;ACLA;;AAEmC;AACE;AACC;AACE;;AAExC;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,YAAY,2DAAO;;AAEnB;;AAEA;;AAEA,sBAAsB,oEAAgB;AACtC;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,YAAY,yDAAK,GAAG,yDAAa;AACjC,YAAY,4DAAQ;AACpB,YAAY,iEAAa;AACzB,YAAY,+DAAW;;AAEvB;;AAEA;;AAEA,sBAAsB,oEAAgB;AACtC;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA,YAAY,yDAAK,GAAG,yDAAa;AACjC,YAAY,4DAAQ;AACpB,YAAY,+DAAW;;AAEvB;;AAEA;AACA,8BAA8B,wBAAwB;;AAEtD,kBAAkB,0DAAW;;AAE7B;AACA;AACA,gBAAgB,2DAAO,WAAW,kDAAS;AAC3C;;AAEA,YAAY,kEAAc;AAC1B;AACA,YAAY,+DAAW;;AAEvB;;AAEA;;AAEA,sBAAsB,6DAAiB;AACvC,YAAY,2DAAO;AACnB;AACA;AACA,oBAAoB,oDAAQ;AAC5B;AACA,8BAA8B,sDAAE;;AAEhC;;AAEA;AACA;AACA;;AAEA;;AAEA,YAAY,6DAAoB,CAAC,sDAAE;;AAEnC;AACA,gBAAgB,6DAAS;AACzB;;AAEA;;AAEA;;AAEA;AACA;AACA,sBAAsB,2DAAO;AAC7B,aAAa;;AAEb;;AAEA;;AAEA,kBAAkB,0DAAW;;AAE7B,kCAAkC,2DAAO;AACzC,gBAAgB,2DAAO,oBAAoB,sDAAE;AAC7C;;AAEA,kCAAkC,+DAAW;;AAE7C;;AAEA;;AAEA,YAAY,yDAAK,GAAG,yDAAa;AACjC,YAAY,4DAAQ;AACpB,YAAY,+DAAW;;AAEvB;;AAEA;;AAEA,YAAY,yDAAK,GAAG,yDAAa;AACjC,YAAY,4DAAQ;;AAEpB;;AAEA;;AAEA,YAAY,qEAAiB;;AAE7B;AACA;;AAEA;;AAEA;;AAEA,2DAAO;;AAEP;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,8BAA8B,WAAW;;AAEzC;;AAEA;;AAEA","file":"script_ww.worker.js","sourcesContent":["export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nexport default function _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct.js\";\nexport default function _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    _construct = Reflect.construct;\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","export default function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","module.exports = require(\"regenerator-runtime\");\n","/**\n * Utility compare functions\n */\n\nmodule.exports = {\n\n    /**\n     * Compare two numbers.\n     *\n     * @param {Number} a\n     * @param {Number} b\n     * @returns {Number} 1 if a > b, 0 if a = b, -1 if a < b\n     */\n    numcmp: function (a, b) {\n        return a - b;\n    },\n\n    /**\n     * Compare two strings.\n     *\n     * @param {Number|String} a\n     * @param {Number|String} b\n     * @returns {Number} 1 if a > b, 0 if a = b, -1 if a < b\n     */\n    strcmp: function (a, b) {\n        return a < b ? -1 : a > b ? 1 : 0;\n    }\n\n};\n","/**\n * Indexed Array Binary Search module\n */\n\n/**\n * Dependencies\n */\nvar util = require(\"./util\"),\n    cmp = require(\"./compare\"),\n    bin = require(\"./search/binary\");\n\n/**\n * Module interface definition\n */\nmodule.exports = IndexedArray;\n\n/**\n * Indexed Array constructor\n *\n * It loads the array data, defines the index field and the comparison function\n * to be used.\n *\n * @param {Array} data is an array of objects\n * @param {String} index is the object's property used to search the array\n */\nfunction IndexedArray(data, index) {\n\n    // is data sortable array or array-like object?\n    if (!util.isSortableArrayLike(data))\n        throw new Error(\"Invalid data\");\n\n    // is index a valid property?\n    if (!index || data.length > 0 && !(index in data[0]))\n        throw new Error(\"Invalid index\");\n\n    // data array\n    this.data = data;\n\n    // name of the index property\n    this.index = index;\n\n    // set index boundary values\n    this.setBoundaries();\n\n    // default comparison function\n    this.compare = typeof this.minv === \"number\" ? cmp.numcmp : cmp.strcmp;\n\n    // default search function\n    this.search = bin.search;\n\n    // cache of index values to array positions\n    // each value stores an object as { found: true|false, index: array-index }\n    this.valpos = {};\n\n    // cursor and adjacent positions\n    this.cursor = null;\n    this.nextlow = null;\n    this.nexthigh = null;\n}\n\n/**\n * Set the comparison function\n *\n * @param {Function} fn to compare index values that returnes 1, 0, -1\n */\nIndexedArray.prototype.setCompare = function (fn) {\n    if (typeof fn !== \"function\")\n        throw new Error(\"Invalid argument\");\n\n    this.compare = fn;\n    return this;\n};\n\n/**\n * Set the search function\n *\n * @param {Function} fn to search index values in the array of objects\n */\nIndexedArray.prototype.setSearch = function (fn) {\n    if (typeof fn !== \"function\")\n        throw new Error(\"Invalid argument\");\n\n    this.search = fn;\n    return this;\n};\n\n/**\n * Sort the data array by its index property\n */\nIndexedArray.prototype.sort = function () {\n    var self = this,\n        index = this.index;\n\n    // sort the array\n    this.data.sort(function (a, b) {\n        return self.compare(a[index], b[index]);\n    });\n\n    // recalculate boundary values\n    this.setBoundaries();\n\n    return this;\n};\n\n/**\n * Inspect and set the boundaries of the internal data array\n */\nIndexedArray.prototype.setBoundaries = function () {\n    var data = this.data,\n        index = this.index;\n\n    this.minv = data.length && data[0][index];\n    this.maxv = data.length && data[data.length - 1][index];\n\n    return this;\n};\n\n/**\n * Get the position of the object corresponding to the given index\n *\n * @param {Number|String} index is the id of the requested object\n * @returns {Number} the position of the object in the array\n */\nIndexedArray.prototype.fetch = function (value) {\n    // check data has objects\n    if (this.data.length === 0) {\n        this.cursor = null;\n        this.nextlow = null;\n        this.nexthigh = null;\n        return this;\n    }\n\n    // check the request is within range\n    if (this.compare(value, this.minv) === -1) {\n        this.cursor = null;\n        this.nextlow = null;\n        this.nexthigh = 0;\n        return this;\n    }\n    if (this.compare(value, this.maxv) === 1) {\n        this.cursor = null;\n        this.nextlow = this.data.length - 1;\n        this.nexthigh = null;\n        return this;\n    }\n\n    var valpos = this.valpos,\n        pos = valpos[value];\n\n    // if the request is memorized, just give it back\n    if (pos) {\n        if (pos.found) {\n            this.cursor = pos.index;\n            this.nextlow = null;\n            this.nexthigh = null;\n        } else {\n            this.cursor = null;\n            this.nextlow = pos.prev;\n            this.nexthigh = pos.next;\n        }\n        return this;\n    }\n\n    // if not, do the search\n    var result = this.search.call(this, value);\n    this.cursor = result.index;\n    this.nextlow = result.prev;\n    this.nexthigh = result.next;\n    return this;\n};\n\n/**\n * Get the object corresponding to the given index\n *\n * When no value is given, the function will default to the last fetched item.\n *\n * @param {Number|String} [optional] index is the id of the requested object\n * @returns {Object} the found object or null\n */\nIndexedArray.prototype.get = function (value) {\n    if (value)\n        this.fetch(value);\n\n    var pos = this.cursor;\n    return pos !== null ? this.data[pos] : null;\n};\n\n/**\n * Get an slice of the data array\n *\n * Boundaries have to be in order.\n *\n * @param {Number|String} begin index is the id of the requested object\n * @param {Number|String} end index is the id of the requested object\n * @returns {Object} the slice of data array or []\n */\nIndexedArray.prototype.getRange = function (begin, end) {\n    // check if boundaries are in order\n    if (this.compare(begin, end) === 1) {\n        return [];\n    }\n\n    // fetch start and default to the next index above\n    this.fetch(begin);\n    var start = this.cursor || this.nexthigh;\n\n    // fetch finish and default to the next index below\n    this.fetch(end);\n    var finish = this.cursor || this.nextlow;\n\n    // if any boundary is not set, return no range\n    if (start === null || finish === null) {\n        return [];\n    }\n\n    // return range\n    return this.data.slice(start, finish + 1);\n};\n","/**\n * Binary search implementation\n */\n\n/**\n * Main search recursive function\n */\nfunction loop(data, min, max, index, valpos) {\n\n    // set current position as the middle point between min and max\n    var curr = (max + min) >>> 1;\n\n    // compare current index value with the one we are looking for\n    var diff = this.compare(data[curr][this.index], index);\n\n    // found?\n    if (!diff) {\n        return valpos[index] = {\n            \"found\": true,\n            \"index\": curr,\n            \"prev\": null,\n            \"next\": null\n        };\n    }\n\n    // no more positions available?\n    if (min >= max) {\n        return valpos[index] = {\n            \"found\": false,\n            \"index\": null,\n            \"prev\": (diff < 0) ? max : max - 1,\n            \"next\": (diff < 0) ? max + 1 : max\n        };\n    }\n\n    // continue looking for index in one of the remaining array halves\n    // current position can be skept as index is not there...\n    if (diff > 0)\n        return loop.call(this, data, min, curr - 1, index, valpos);\n    else\n        return loop.call(this, data, curr + 1, max, index, valpos);\n}\n\n/**\n * Search bootstrap\n * The function has to be executed in the context of the IndexedArray object\n */\nfunction search(index) {\n    var data = this.data;\n    return loop.call(this, data, 0, data.length - 1, index, this.valpos);\n}\n\n/**\n * Export search function\n */\nmodule.exports.search = search;\n","/**\n * Utils module\n */\n\n/**\n * Check if an object is an array-like object\n *\n * @credit Javascript: The Definitive Guide, O'Reilly, 2011\n */\nfunction isArrayLike(o) {\n    if (o &&                                 // o is not null, undefined, etc.\n        typeof o === \"object\" &&             // o is an object\n        isFinite(o.length) &&                // o.length is a finite number\n        o.length >= 0 &&                     // o.length is non-negative\n        o.length === Math.floor(o.length) && // o.length is an integer\n        o.length < 4294967296)               // o.length < 2^32\n        return true;                         // Then o is array-like\n    else\n        return false;                        // Otherwise it is not\n}\n\n/**\n * Check for the existence of the sort function in the object\n */\nfunction isSortable(o) {\n    if (o &&                                 // o is not null, undefined, etc.\n        typeof o === \"object\" &&             // o is an object\n        typeof o.sort === \"function\")        // o.sort is a function\n        return true;                         // Then o is array-like\n    else\n        return false;                        // Otherwise it is not\n}\n\n/**\n * Check for sortable-array-like objects\n */\nmodule.exports.isSortableArrayLike = function (o) {\n    return isArrayLike(o) && isSortable(o);\n};\n","\n// Dataset proxy between vuejs & WebWorker\n\nimport { now } from './script_utils.js'\n\nexport default class Dataset {\n\n    constructor(dc, desc) {\n\n        // TODO: dataset url arrow fn tells WW\n        // to load the ds directly from web\n\n        this.type = desc.type\n        this.id = desc.id\n        this.dc = dc\n\n        // Send the data to WW\n        if (desc.data) {\n            this.dc.ww.just('upload-data', {\n                [this.id]: desc\n            })\n            // Remove the data from the descriptor\n            delete desc.data\n        }\n\n        let proto = Object.getPrototypeOf(this)\n        Object.setPrototypeOf(desc, proto)\n        Object.defineProperty(desc, 'dc', {\n            get() { return dc }\n        })\n\n    }\n\n    // Watch for the changes of descriptors\n    static watcher(n, p) {\n        let nids = n.map(x => x.id)\n        let pids = p.map(x => x.id)\n\n        for (var id of nids) {\n            if (!pids.includes(id)) {\n                let ds = n.filter(x => x.id === id)[0]\n                this.dss[id] = new Dataset(this, ds)\n            }\n        }\n\n        for (var id of pids) {\n            if (!nids.includes(id) && this.dss[id]) {\n                this.dss[id].remove()\n            }\n        }\n    }\n\n    // Make an object for data transfer\n    static make_tx(dc, types) {\n\n        let main = dc.data.chart.data\n        let base = {}\n        if (types.find(x => x.type === 'OHLCV')) {\n            base = { ohlcv: main }\n        }\n\n        // TODO: add more sophisticated search\n        // (using 'script.datasets' paramerter)\n        /*for (var req of types) {\n            let ds = Object.values(dc.dss || {})\n                .find(x => x.type === req.type)\n            if (ds && ds.data) {\n                base[ds.id] = {\n                    id: ds.id,\n                    type: ds.type,\n                    data: ds.data\n                }\n            }\n        }*/\n        // TODO: Data request callback ?\n\n        return base\n    }\n\n    // Set data (overwrite the whole dataset)\n    set(data, exec = true) {\n        this.dc.ww.just('dataset-op', {\n            id: this.id,\n            type: 'set',\n            data: data,\n            exec: exec\n        })\n    }\n\n    // Update with new data (array of data points)\n    update(arr) {\n        this.dc.ww.just('update-data', {\n            [this.id]: arr\n        })\n    }\n\n    // Send WW a chunk to merge. The merge algo\n    // here is simpler than in DC. It just adds\n    // data at the beginning or/and the end of ds\n    merge(data, exec = true) {\n        this.dc.ww.just('dataset-op', {\n            id: this.id,\n            type: 'mrg',\n            data: data,\n            exec: exec\n        })\n    }\n\n    // Remove the ds from WW\n    remove(exec = true) {\n        this.dc.del(`datasets.${this.id}`)\n        this.dc.ww.just('dataset-op', {\n            id: this.id,\n            type: 'del',\n            exec: exec\n        })\n        delete this.dc.dss[this.id]\n    }\n\n    // Fetch data from WW\n    async data() {\n        let ds = await this.dc.ww.exec(\n            'get-dataset',\n            this.id\n        )\n        if (!ds) return\n        return ds.data\n    }\n\n}\n\n// Dataset reciever (created on WW)\n\nexport class DatasetWW {\n\n    constructor(id, data) {\n        this.last_upd = now()\n        this.id = id\n        if (Array.isArray(data)) {\n            // Regular array\n            this.data = data\n            if (id === 'ohlcv') this.type = 'OHLCV'\n        } else {\n            // Dataset descriptor\n            this.data = data.data\n            this.type = data.type\n        }\n    }\n\n    // Update from 'update-data' event\n    // TODO: ds size limit (in MB / data points)\n    static update_all(se, data) {\n        for (var k in data) {\n            if (k === 'ohlcv') continue\n            let id = k.split('.')[1] || k\n            if (!se.data[id]) continue\n            let arr = se.data[id].data\n            let iN = arr.length - 1\n            let last = arr[iN]\n\n            for (var dp of data[k]) {\n                if (!last || dp[0] > last[0]) {\n                    arr.push(dp)\n                }\n            }\n            se.data[id].last_upd = now()\n        }\n    }\n\n    merge(data) {\n        let len = this.data.length\n        if (!len) {\n            this.data = data\n            return\n        }\n        let t0 = this.data[0][0]\n        let tN = this.data[len - 1][0]\n        let l = data.filter(x => x[0] < t0)\n        let r = data.filter(x => x[0] > tN)\n        this.data = l.concat(this.data, r)\n    }\n\n    // On dataset operation\n    op(se, op) {\n        this.last_upd = now()\n        switch(op.type) {\n            case 'set':\n                this.data = op.data\n                se.recalc_size()\n                break\n            case 'del':\n                delete se.data[this.id]\n                se.recalc_size()\n                break\n            case 'mrg':\n                this.merge(op.data)\n                se.recalc_size()\n                break\n        }\n    }\n}\n","// Resamples candles\n\nimport se from './script_engine.js'\n\nconst DEF_LIMIT = 5   // default buff length\n\nexport default function(T, auto = false) {\n\n    // Define a TS type (part of the candle)\n    let Ti = ['high', 'low', 'close', 'vol'].indexOf(T)\n\n    return function(x, t) {\n\n        let tf = this.__tf__\n        let id = this.__id__\n        t = t || se.t\n        let val = auto ? se[T][0] : x\n        // TODO: closing at a specific time\n        // (timezone, end of the month...)\n        if (!this.__t0__ || t >= this.__t0__ + tf) {\n\n            this.unshift(Ti !== 3 ? val : 0)\n            this.__t0__ = t - t % tf\n            // TODO: new candle signal\n        }\n\n        // Update prices\n        switch(Ti) {\n            case 0:\n                if (val > this[0]) this[0] = val\n                break\n            case 1:\n                if (val < this[0]) this[0] = val\n                break\n            case 2:\n                this[0] = val\n                break\n            case 3:\n                this[0] += val\n        }\n\n        // Limit size of vector\n        this.length = this.__len__ || DEF_LIMIT\n    }\n}\n","\n// Script engine, Fuck yeah\n\nimport ScriptEnv from './script_env.js'\nimport Utils from '../stuff/utils.js'\nimport * as u from './script_utils.js'\nimport symstd from './symstd.js'\nimport TS from './script_ts.js'\n\nconst DEF_LIMIT = 5   // default buff length\nconst WAIT_EXEC = 10  // merge script execs, ms\n\nclass ScriptEngine {\n\n    constructor() {\n        this.map = {}\n        this.data = {}\n        this.exec_id = null\n        this.queue = []         // Script exec queue\n        this.delta_queue = []   // Settings queue\n        this.update_queue = []  // Live update queue\n        this.sett = {}\n        this.state = {}\n        this.mods = {}          // Modules (extensions)\n        this.std_plus = {}      // Functions to inject\n        this.tf = undefined     // Main chart TF\n    }\n\n    exec_all() {\n\n        clearTimeout(this.exec_id)\n\n        // Wait for the data\n        if (!this.data.ohlcv) return\n\n        // Execute queue after all scripts & data are loaded\n        this.exec_id = setTimeout(async () => {\n\n            if (!this.init_state(Object.keys(this.map))) {\n                return\n            }\n            this.re_init_map()\n\n            while (this.queue.length) {\n                this.exec(this.queue.shift())\n            }\n\n            if (Object.keys(this.map).length) {\n                await this.run()\n                this.drain_queues()\n            }\n\n            this.send_state()\n\n        }, WAIT_EXEC)\n    }\n\n    // Exec selected\n    async exec_sel(delta) {\n\n        // Wait for the data\n        // TODO: Check data requirements\n        if (!this.data.ohlcv) return\n\n        let sel = Object.keys(delta).filter(x => x in this.map)\n\n        if (!this.init_state(sel)) {\n            this.delta_queue.push(delta)\n            return\n        }\n\n        for (var id in delta) {\n            if (!this.map[id]) continue\n\n            let props = this.map[id].src.props || {}\n            for (var k in props) {\n                if (k in delta[id]) {\n                    props[k].val = delta[id][k]\n                }\n            }\n\n            this.exec(this.map[id])\n\n        }\n\n        await this.run(sel)\n        this.drain_queues()\n        this.send_state()\n\n    }\n\n    // Exec script (create a new ScriptEnv, add to the map)\n    exec(s) {\n\n        if (!s.src.conf) s.src.conf = {}\n\n        if (s.src.init) {\n            s.src.init_src = u.get_raw_src(s.src.init)\n        }\n        if (s.src.update) {\n            s.src.upd_src = u.get_raw_src(s.src.update)\n        }\n        if (s.src.post) {\n            s.src.post_src = u.get_raw_src(s.src.post)\n        }\n\n        // Parse non-default symbols\n        symstd.parse(s)\n\n        for (var id in this.mods) {\n            if (this.mods[id].pre_env) {\n                this.mods[id].pre_env(s.uuid, s)\n            }\n        }\n\n        s.env = new ScriptEnv(s, Object.assign(this.shared, {\n            open: this.open,\n            high: this.high,\n            low: this.low,\n            close: this.close,\n            vol: this.vol,\n            dss: this.data,\n            t: () => this.t,\n            iter: () => this.iter,\n            tf: this.tf,\n            range: this.range,\n            onclose: true\n        }, this.tss))\n\n        this.map[s.uuid] = s\n\n        for (var id in this.mods) {\n            if (this.mods[id].new_env) {\n                this.mods[id].new_env(s.uuid, s)\n            }\n        }\n\n        // Build te box after mod's interfaces injected\n        s.env.build()\n    }\n\n    // Live update\n    update(candles) {\n\n        if (!this.data.ohlcv || !this.data.ohlcv.data.length) {\n            return\n        }\n\n        if (this.running) {\n            this.update_queue.push(candles)\n            return\n        }\n\n        let mfs1 = this.make_mods_hooks('pre_step')\n        let mfs2 = this.make_mods_hooks('post_step')\n\n        let step = (sel, unshift) => {\n            for (var m = 0; m < mfs1.length; m++) {\n                mfs1[m](sel) // pre_step\n            }\n\n            for (var id of sel) {\n                this.map[id].env.step(unshift)\n            }\n\n            for (var m = 0; m < mfs2.length; m++) {\n                mfs2[m](sel) // post_step\n            }\n        }\n\n        try {\n            let ohlcv = this.data.ohlcv.data\n            let i = ohlcv.length - 1\n            let last = ohlcv[i]\n            let sel = Object.keys(this.map)\n            let unshift = false\n            this.shared.event = 'update'\n\n            for (var candle of candles) {\n                if (candle[0] > last[0]) {\n                    this.shared.onclose = true\n                    step(sel, false) // On candle close\n                    ohlcv.push(candle)\n                    unshift = true\n                    i++\n                } else if (candle[0] < last[0]) {\n                    continue\n                } else {\n                    ohlcv[i] = candle\n                }\n            }\n\n            this.iter = i\n            this.t = ohlcv[i][0]\n            this.step(ohlcv[i], unshift)\n\n            this.shared.onclose = false\n            step(sel, unshift)\n\n            this.limit()\n            this.send_update()\n            this.send_state()\n\n        } catch(e) {\n            console.log(e)\n        }\n    }\n\n    init_state(sel) {\n\n        let task = sel.join(',')\n\n        // Stop previous run only if the task is the same\n        if (this.running) {\n            this._restart = (task === this.task)\n            return false\n        }\n\n        // Inverted arrays\n        this.open = TS('open', [])\n        this.high = TS('high', [])\n        this.low = TS('low', [])\n        this.close = TS('close', [])\n        this.vol = TS('vol', [])\n\n        // Shared TSs & user vars\n        this.tss = {}\n        this.std_plus = {}\n        this.shared = {}\n\n        // Engine state\n        this.iter = 0\n        this.t = 0\n        this.skip = false // skip the step\n        this.running = true\n        this.task = task\n\n        return true\n    }\n\n    // Inject/override functions in the std lib object\n    std_inject(std) {\n        let proto = Object.getPrototypeOf(std)\n        Object.assign(proto, this.std_plus)\n        return std\n    }\n\n    send_state() {\n        this.send('engine-state', {\n            scripts: Object.keys(this.map).length,\n            last_perf: this.perf,\n            iter: this.iter,\n            last_t: this.t,\n            data_size: this.data_size,\n            running: false\n        })\n    }\n\n    send_update() {\n        this.send(\n            'overlay-update', this.format_update()\n        )\n    }\n\n    re_init_map() {\n        for (var id in this.map) {\n            this.exec(this.map[id])\n        }\n    }\n\n    async run(sel) {\n\n        this.send('engine-state', { running: true })\n\n        var t1 = Utils.now()\n        sel = sel || Object.keys(this.map)\n\n        this.pre_run_mods(sel)\n        let mfs1 = this.make_mods_hooks('pre_step')\n        let mfs2 = this.make_mods_hooks('post_step')\n\n        try {\n\n            for (var id of sel) {\n                this.map[id].env.init()\n            }\n\n            let ohlcv = this.data.ohlcv.data\n            let start = this.start(ohlcv)\n            this.shared.event = 'step'\n\n            for (var i = start; i < ohlcv.length; i++) {\n\n                // Make a pause to read new WW msg\n                // TODO: speedup pause()\n                // TODO: emit progress %\n                if (i % 5000 === 0) await Utils.pause(0)\n                if (this.restarted()) return\n\n                this.iter = i - start\n                this.t = ohlcv[i][0]\n                this.step(ohlcv[i])\n                this.shared.onclose = i !== ohlcv.length - 1\n\n                // SLOW DOWN TEST:\n                //for (var k = 1; k < 1000000; k++) {}\n                for (var m = 0; m < mfs1.length; m++) {\n                    mfs1[m](sel) // pre_step\n                }\n\n                for (var id of sel) this.map[id].env.step()\n\n                for (var m = 0; m < mfs2.length; m++) {\n                    mfs2[m](sel) // post_step\n                }\n\n                if (this.custom_main) this.make_ohlcv()\n                this.limit()\n            }\n\n            for (var id of sel) {\n                this.map[id].env.output.post()\n            }\n\n        } catch(e) {\n            console.log(e)\n        }\n\n        this.post_run_mods(sel)\n\n        this.perf = Utils.now() - t1\n        this.running = false\n\n        this.send('overlay-data', this.format_map(sel))\n    }\n\n    step(data, unshift = true) {\n        if (unshift) {\n            this.open.unshift(data[1])\n            this.high.unshift(data[2])\n            this.low.unshift(data[3])\n            this.close.unshift(data[4])\n            this.vol.unshift(data[5])\n            for (var id in this.tss) {\n                if (this.tss[id].__tf__) this.tss[id].__fn__()\n                else this.tss[id].unshift(this.tss[id].__fn__())\n            }\n        } else {\n            this.open[0] = data[1]\n            this.high[0] = data[2]\n            this.low[0] = data[3]\n            this.close[0] = data[4]\n            this.vol[0] = data[5]\n            for (var id in this.tss) {\n                if (this.tss[id].__tf__) this.tss[id].__fn__()\n                else this.tss[id][0] = this.tss[id].__fn__()\n            }\n        }\n    }\n\n\n    limit() {\n        this.open.length = this.open.__len__ || DEF_LIMIT\n        this.high.length = this.high.__len__ || DEF_LIMIT\n        this.low.length = this.low.__len__ || DEF_LIMIT\n        this.close.length = this.close.__len__ || DEF_LIMIT\n        this.vol.length = this.vol.__len__ || DEF_LIMIT\n    }\n\n    start(ohlcv) {\n        let depth = this.sett.script_depth\n        return depth ?\n            Math.max(ohlcv.length - depth, 0) : 0\n    }\n\n    drain_queues() {\n\n        // Check if there are any new scripts (recieved during\n        // the current run)\n        if (this.queue.length) {\n            this.exec_all()\n        }\n        // Check if there are any new settings deltas (...)\n        else if (this.delta_queue.length) {\n            this.exec_sel(this.delta_queue.pop())\n            this.delta_queue = []\n        }\n        else {\n            while (this.update_queue.length) {\n                let c = this.update_queue.shift()\n                this.update(c)\n            }\n        }\n    }\n\n    format_map(sel, range, output) {\n        sel = sel || Object.keys(this.map)\n        let res = []\n        for (var id of sel) {\n            let x = this.map[id]\n            let f = x => x\n            if ((x.output === false || x.output === 'none') &&\n                !output) {\n                res.push({id: id, data: null})\n                continue\n            }\n            if (x.output === 'range' || range) {\n                var [t1, t2] = range || this.range\n                f = x => x.filter(\n                    y => y[0] >= t1 && y[0] <= t2\n                )\n            }\n            res.push({\n                id: id, data: f(x.env.data), new_ovs: {\n                    onchart: u.ovf(x.env.onchart, f),\n                    offchart: u.ovf(x.env.offchart, f)\n                }\n            })\n        }\n        if (this.custom_main) {\n            res.push({\n                id: 'chart',\n                data: this.data.ohlcv.data\n            })\n        }\n        return res\n    }\n\n    format_update() {\n        let res = []\n        for (var id in this.map) {\n            let x = this.map[id]\n            if (x.output === false) {\n                res.push({id: id, data: null})\n                continue\n            }\n            res.push({\n                id: id,\n                data: x.env.data[x.env.data.length - 1]\n            })\n            for (var side of ['onchart', 'offchart']) {\n                for (var id in x.env[side]) {\n                    let y = x.env[side][id]\n                    res.push({\n                        id: `${side}.${id}`,\n                        data: y.data[y.data.length - 1]\n                    })\n                }\n            }\n        }\n        return res\n    }\n\n    restarted() {\n        if (this._restart) {\n            this._restart = false\n            this.running = false\n            this.perf = 0\n            //console.log('Restarted')\n            return true\n        }\n        return false\n    }\n\n    remove_scripts(ids) {\n        for (var id of ids) delete this.map[id]\n        this.send_state()\n    }\n\n    pre_run_mods(sel) {\n        for (var id in this.mods) {\n            if (this.mods[id].pre_run) {\n                this.mods[id].pre_run(sel)\n            }\n        }\n    }\n\n    post_run_mods(sel) {\n        for (var id in this.mods) {\n            if (this.mods[id].post_run) {\n                this.mods[id].post_run(sel)\n            }\n        }\n    }\n\n    make_mods_hooks(name) {\n        let arr = []\n        for (var id in this.mods) {\n            if (this.mods[id][name]) {\n                arr.push(this.mods[id][name]\n                    .bind(this.mods[id]))\n            }\n        }\n        return arr\n    }\n\n    data_required(s) {\n\n        let all = Object.values(this.map)\n        if (s) all.push(s)\n\n        let types = [{ type: 'OHLCV' }]\n        for (var s of all) {\n            if (s.src.data) {\n                let reqs = Object.values(s.src.data)\n                types.push(...reqs.map(x => ({\n                    id: s.uuid,\n                    type: x.type\n                })))\n            }\n        }\n        let unf = types.filter(x =>\n            !Object.values(this.data)\n            .find(y => y.type === x.type)\n        )\n        return unf.length ? unf : null\n    }\n\n    // Match dataset id using script id & required type\n    match_ds(id, type) {\n        // TODO: develop further\n        for (var id in this.data) {\n            if (this.data[id].type === type) {\n                return id\n            }\n        }\n    }\n\n    // Make a ohlcv data point if there is a symbol\n    // with { main: true } props (overwrites ohlcv).\n    make_ohlcv() {\n        let sym = this.custom_main\n        let tNext = this.t + this.tf\n        if (sym.update(null, tNext)) {\n            this.data.ohlcv.data.push([\n                tNext,\n                sym.open[0],\n                sym.high[0],\n                sym.low[0],\n                sym.close[0],\n                sym.vol[0]\n            ])\n        }\n    }\n\n    // Calculate data size\n    recalc_size() {\n        while(true) {\n            var sz = u.size_of_dss(this.data) / (1024 * 1024)\n            let lim = this.sett.ww_ram_limit\n            if (lim && sz > lim) {\n                this.limit_size()\n            } else break\n        }\n        this.data_size = +sz.toFixed(2)\n        this.send_state()\n    }\n\n    // Limit data size by throwing out the least\n    // active datasets (measured by 'last_upd')\n    limit_size() {\n        let dss = Object.values(this.data).map(x => ({\n            id: x.id,\n            t: x.last_upd\n        }))\n        dss.sort((a, b) => a.t - b.t)\n        if (dss.length) {\n            delete this.data[dss[0].id]\n        }\n    }\n}\n\nexport default new ScriptEngine()\n","\n// Script environment. Packs everything that\n// needed for a script execution together:\n// script src, standart functions, input data,\n// other overlays & dependencies\n\nimport ScriptStd from './script_std.js'\nimport se from './script_engine.js'\nimport * as u from './script_utils.js'\nimport TS from './script_ts.js'\n\nconst FDEFS1 = /(function |)([$A-Z_][0-9A-Z_$\\.]*)[\\s]*?\\((.*?\\s*)\\)/mi\nconst FDEFS2 = /(function |)([$A-Z_][0-9A-Z_$\\.]*)[\\s]*?\\((.*\\s*)\\)/gmis\nconst DEF_LIMIT = 5\n\nexport default class ScriptEnv {\n\n    constructor(s, data) {\n\n        this.std = se.std_inject(new ScriptStd(this))\n        this.id = s.uuid\n        this.src = s\n        this.output = TS('output', [])\n        this.data = []\n        this.tss = {}\n        this.syms = {}\n        this.shared = data\n        this.output.box_maker = this.make_box(s.src)\n        this.onchart = {}\n        this.offchart = {}\n    }\n\n    build() {\n        this.output.box_maker(this, this.shared, se)\n        delete this.output.box_maker\n    }\n\n    init() {\n        this.output.init()\n    }\n\n    step(unshift = true) {\n        if (unshift) this.unshift()\n        let v = this.output.update()\n        this.copy(v, unshift)\n        this.limit()\n    }\n\n    unshift() {\n        this.output.unshift(undefined)\n        // Update all temp symbols\n        for (var id in this.tss) {\n            if (this.tss[id].__tf__) continue\n            this.tss[id].unshift(undefined)\n        }\n    }\n\n    // Limit env.output length\n    limit() {\n        let out = this.output\n        out.length = out.__len__ || DEF_LIMIT\n        for (var id in this.tss) {\n            let ts = this.tss[id]\n            //console.log(ts.__id__, ts.__len__)\n            ts.length = ts.__len__ || DEF_LIMIT\n        }\n    }\n\n    // Copy the recent value to the direct buff\n    copy(v, unshift = true) {\n        let off = this.output.__offset__\n        if (v != undefined) {\n            this.output[0] = v.__id__ ? v[0] : v\n            off = off || v.__offset__\n        }\n        let val = this.output[0]\n        let t = se.t\n        if (off) t += off * se.tf\n        if (val == null || !val.length) {\n            // Number / object\n            var point = [t, val]\n        } else {\n            // Array\n            point = [t, ...val]\n        }\n        if (unshift) {\n            this.data.push(point)\n        } else {\n            this.data[this.data.length - 1] = point\n        }\n    }\n\n    // A small sandbox for a particular script\n    // TODO: add support of 'Source' prop type (open, high, hl2 ...)\n    make_box(src) {\n\n        let proto = Object.getPrototypeOf(this.std)\n        let std = ``\n        for (var k of Object.getOwnPropertyNames(proto)) {\n            if (k === 'constructor') continue\n            std += `const std_${k} = self.std.${k}.bind(self.std)\\n`\n        }\n\n        let props = ``\n        for (var k in src.props || {}) {\n            if (src.props[k].val !== undefined) {\n                var val = src.props[k].val\n            } else if (this.src.sett[k] !== undefined) {\n                val = this.src.sett[k]\n            } else {\n                val = src.props[k].def\n            }\n            props += `var ${k} = ${JSON.stringify(val)}\\n`\n        }\n        // TODO: add argument values to _id\n\n        let tss = ``\n        for (var k in this.shared) {\n            if (this.shared[k] && this.shared[k].__id__) {\n                tss += `const ${k} = shared.${k}\\n`\n            }\n        }\n\n        // Datasets\n        let dss = ``\n        for (var k in src.data || {}) {\n            let id = se.match_ds(this.id, src.data[k].type)\n            if (!this.shared.dss[id]) {\n                let T = src.data[k].type\n                console.warn(`Dataset '${T}' is undefined`)\n                continue\n            }\n            dss += `const ${k} = shared.dss['${id}'].data\\n`\n        }\n\n        try {\n            return Function('self,shared,se', `\n                'use strict';\n\n                // Built-in functions (aliases)\n                ${std}\n\n                // Modules (API / interfaces)\n                ${this.make_modules()}\n\n                // Timeseries\n                ${tss}\n\n                // Direct data ts\n                const data = self.data\n                const ohlcv = shared.dss.ohlcv.data\n                ${dss}\n\n                // Script's properties (init)\n                ${props}\n\n                // Globals\n                const settings = self.src.sett\n                const tf = shared.tf\n                const range = shared.range\n\n                this.init = (_id = 'root') => {\n                    ${this.prep(src.init_src)}\n                }\n\n                this.update = (_id = 'root') => {\n                    const t = shared.t()\n                    const iter = shared.iter()\n                    ${this.prep(src.upd_src)}\n                }\n\n                this.post = (_id = 'root') => {\n                    ${this.prep(src.post_src)}\n                }\n            `)\n        } catch(e) {\n            return Function('self,shared', `\n                'use strict';\n                this.init = () => {}\n                this.update = () => {}\n                this.post = () => {}\n            `)\n        }\n    }\n\n    // Make definitions for modules\n    make_modules() {\n        let s = ``\n        for (var id in se.mods) {\n            if (!se.mods[id].api) continue\n            s += `const ${id} = se.mods['${id}'].api[self.id]`\n            s += '\\n'\n        }\n        return s\n    }\n\n    // Preprocess the update function.\n    // Replace functions with the full arguments list +\n    // generate & add tsid\n    // TODO: implement recursive prepping (with js syntax parser)\n    prep(src) {\n\n        // console.log('Before -----> \\n', src)\n\n        let h = this.src.use_for[0] // TODO: add props here\n        src = '\\t\\t  let _pref = `${_id}<-'+h+'<-`\\n' + src\n\n        FDEFS2.lastIndex = 0\n        let call_id = 0 // Function call id (to make each call unique)\n\n        do {\n            var m = FDEFS2.exec(src)\n            if (m) {\n                let fkeyword = m[1].trim()\n                let fname = m[2]\n                let fargs = m[3]\n\n                if (fkeyword === 'function') {\n                    // TODO: add _ids to inline functions\n                } else {\n                    let off = m.index + m[0].indexOf('(')\n                    if (this.std[fname]) {\n                        src = this.postfix(src, m, ++call_id)\n                        //console.log(src)\n                        off+=4 // 'std_'\n                    }\n                    // Quick fix\n                    FDEFS2.lastIndex = off\n                }\n            }\n        } while (m)\n\n        // console.log('After ----->\\n', u.wrap_idxs(src))\n\n        return u.wrap_idxs(src, 'std_')\n    }\n\n    // Postfix function calls with ts _ids\n    postfix(src, m, call_id) {\n\n        let target = this.get_args(this.fdef(m[2])).length\n        let m0 = this.parentheses(m[0]) // First closed pair\n        let args = this.get_args_2(m0)\n        for (var i = args.length; i < target; i++) {\n            args.push('void 0')\n        }\n\n        // Add an unique time-series id\n        args.push(`_pref+\"f${call_id}\"`)\n\n        return src.replace(m0, `std_${m[2]}(${args.join(', ')})`)\n\n    }\n\n    parentheses(str) {\n        var count = 0, first = false\n        for (var i = 0; i < str.length; i++) {\n            if (str[i] === '(') {\n                count++\n                first = true\n            } else if (str[i] === ')') {\n                count--\n            }\n            if (first && count === 0) {\n                return str.substr(0, i+1)\n            }\n        }\n        return str\n    }\n\n    // Get the function definition\n    // TODO: add support of modules\n    fdef(fname) {\n        return this.std[fname].toString()\n    }\n\n    // Get args in the function's definition\n    get_args(src) {\n        let reg = this.regex_clone(FDEFS1)\n        reg.lastIndex = 0\n\n        let m = reg.exec(src)\n        if (!m[3].trim().length) return []\n        let arr = m[3].split(',')\n            .map(x => x.trim())\n            .filter(x => x !== '_id' && x !== '_tf')\n        return arr\n    }\n\n    get_args_2(str) {\n        let parts = []\n        let c = 0\n        let s = 0\n        var q1 = false, q2 = false, q3 = false\n        let part\n        for (var i = 0; i < str.length; i++) {\n            if (str[i] === '(') {\n                c++\n                if (!part) part = [i+1]\n            }\n            if (str[i] === ')') c--\n            if (str[i] === '[') s++\n            if (str[i] === ']') s--\n            if (str[i] === \"'\") q1 = !q1\n            if (str[i] === '\"') q2 = !q2\n            if (str[i] === '`') q3 = !q3\n            if (str[i] === ',' && c === 1 && !s && !q1 && !q2 && !q3) {\n                if (part) {\n                    part[1] = i\n                    parts.push(part)\n                    part = [i+1]\n                }\n            }\n            if (c === 0 && part) {\n                part[1] = i\n                parts.push(part)\n                part = null\n            }\n        }\n        return parts.map(x => str.slice(...x))\n            .filter(x => /[^\\s]+/.exec(x))\n    }\n\n    regex_clone(rex) {\n        return new RegExp(rex.source, rex.flags)\n    }\n\n    send_modify(upd) {\n        se.send('modify-overlay', {\n            uuid: this.id,\n            fields: upd\n        })\n    }\n}\n","\n// Script std-lib (built-in functions)\n\nimport se from './script_engine.js'\nimport linreg from '../stuff/linreg.js'\nimport * as u from './script_utils.js'\nimport Sampler from './sampler.js'\nimport { Sym, ARR, TSS, NUM } from './symbol.js'\n\nconst BUF_INC = 5\n\nexport default class ScriptStd {\n\n    constructor(env) {\n        this.env = env\n        this.se = se\n\n        this.SWMA = [1/6, 2/6, 2/6, 1/6]\n        this.STDEV_EPS = 1e-10\n        this.STDEV_Z = 1e-4\n\n        this._index_tracking()\n\n    }\n\n    // Wrap every index with index-tracking function\n    // That way we will know exact index ranges\n    _index_tracking() {\n        let proto = Object.getPrototypeOf(this)\n        let std = ``\n        for (var k of Object.getOwnPropertyNames(proto)) {\n            switch(k) {\n                case 'constructor':\n                case 'ts':\n                case 'tstf':\n                case 'sample':\n                case '_index_tracking':\n                case '_tsid':\n                case '_i':\n                case '_v':\n                case '_add_i':\n                case 'chart':\n                case 'onchart':\n                case 'offchart':\n                case 'sym':\n                    continue\n\n            }\n            let f = this._add_i(k, this[k].toString())\n            if (f) this[k] = f\n        }\n\n    }\n\n    // Add index tracking to the function\n    _add_i(name, src) {\n        let args = u.f_args(src)\n        src = u.f_body(src)\n        let src2 = u.wrap_idxs(src, 'this.')\n        if (src2 !== src) {\n            return new Function (...args, src2)\n        }\n        return null\n    }\n\n    // Generate the next timeseries id\n    _tsid(prev, next) {\n        // TODO: prev presence check\n        return `${prev}<-${next}`\n    }\n\n    // Index-tracker\n    _i(i, x) {\n        // If an object is actually a timeseries\n        if (x != undefined && x === x && x.__id__) {\n            // Increase TS buff length\n            if (!x.__len__ || i >= x.__len__) {\n                x.__len__ = i + BUF_INC\n            }\n        }\n        return i\n    }\n\n    // Index-tracker (object-based)\n    _v(x, i) {\n        // If an object is actually a timeseries\n        if (x != undefined && x === x && x.__id__) {\n            // Increase TS buff length\n            if (!x.__len__ || i >= x.__len__) {\n                x.__len__ = i + BUF_INC\n            }\n        }\n        return x\n    }\n\n    /**\n     * Creates a new time-series & records each x.\n     * Returns  an array. Id is auto-genrated\n     * @param {*} x - A variable to sample from\n     * @return {TS} - New time-series\n     */\n    ts(x, _id, _tf) {\n        if (_tf) return this.tstf(x, _tf, _id)\n        let ts = this.env.tss[_id]\n        if (!ts) {\n            ts = this.env.tss[_id] = [x]\n            ts.__id__ = _id\n        } else {\n            ts[0] = x\n        }\n        return ts\n    }\n\n    /**\n     * Creates a new time-series & records each x.\n     * Uses Sampler to aggregate the values\n     * Return the an array. Id is auto-genrated\n     * @param {*} x - A variable to sample from\n     * @param {(number|string)} tf - Timeframe in ms or as a string\n     * @return {TS} - New time-series\n     */\n    tstf(x, tf, _id) {\n        let ts = this.env.tss[_id]\n        if (!ts) {\n            ts = this.env.tss[_id] = [x]\n            ts.__id__ = _id\n            ts.__tf__ = u.tf_from_str(tf)\n            ts.__fn__ = Sampler('close').bind(ts)\n        } else {\n            ts.__fn__(x)\n        }\n        return ts\n    }\n\n    /**\n     * Creates a new custom sampler.\n     * Return the an array. Id is auto-genrated\n     * @param {*} x - A variable to sample from\n     * @param {string} type - Sampler type\n     * @param {(number|string)} tf - Timeframe in ms or as a string\n     * @return {TS} - New time-series\n     */\n    sample(x, type, tf, _id) {\n        let ts = this.env.tss[_id]\n        if (!ts) {\n            ts = this.env.tss[_id] = [x]\n            ts.__id__ = _id\n            ts.__tf__ = u.tf_from_str(tf)\n            ts.__fn__ = Sampler(type).bind(ts)\n        } else {\n            ts.__fn__(x)\n        }\n        return ts\n    }\n\n    /**\n     * Replaces the variable if it's NaN\n     * @param {*} x - The variable\n     * @param {*} [v] - A value to replace with\n     * @return {*} - New value\n     */\n    nz(x, v) {\n        if (x == undefined || x !== x) {\n            return v || 0\n        }\n        return x\n    }\n\n    /**\n     * Is the variable NaN ?\n     * @param {*} x - The variable\n     * @return {boolean} - New value\n     */\n    na(x) {\n        return x == undefined || x !== x\n    }\n\n    /** Replaces the var with NaN if Infinite\n     * @param {*} x - The variable\n     * @param {*} [v] - A value to replace with\n     * @return {*} - New value\n     */\n    nf(x, v) {\n        if (!isFinite(x)) {\n            return v !== undefined ? v : NaN\n        }\n        return x\n    }\n\n    // Math operators on t-series and numbers\n\n    /** Adds values / time-series\n     * @param {(TS|*)} x - First input\n     * @param {(TS|*)} y - Second input\n     * @return {TS} - New time-series\n     */\n    add(x, y, _id) {\n        // __id__ means this is a time-series\n        let id = this._tsid(_id, `add`)\n        let x0 = this.na(x) ? NaN : (x.__id__ ? x[0] : x)\n        let y0 = this.na(y) ? NaN : (y.__id__ ? y[0] : y)\n        return this.ts(x0 + y0, id, x.__tf__)\n    }\n\n    /** Subtracts values / time-series\n     * @param {(TS|*)} x - First input\n     * @param {(TS|*)} y - Second input\n     * @return {TS} - New time-series\n     */\n    sub(x, y, _id) {\n        let id = this._tsid(_id, `sub`)\n        let x0 = this.na(x) ? NaN : (x.__id__ ? x[0] : x)\n        let y0 = this.na(y)? NaN : (y.__id__ ? y[0] : y)\n        return this.ts(x0 - y0, id, x.__tf__)\n    }\n\n    /** Multiplies values / time-series\n     * @param {(TS|*)} x - First input\n     * @param {(TS|*)} y - Second input\n     * @return {TS} - New time-series\n     */\n    mult(x, y, _id) {\n        let id = this._tsid(_id, `mult`)\n        let x0 = this.na(x) ? NaN : (x.__id__ ? x[0] : x)\n        let y0 = this.na(y)? NaN : (y.__id__ ? y[0] : y)\n        return this.ts(x0 * y0, id, x.__tf__)\n    }\n\n    /** Divides values / time-series\n     * @param {(TS|*)} x - First input\n     * @param {(TS|*)} y - Second input\n     * @return {TS} - New time-series\n     */\n    div(x, y, _id) {\n        let id = this._tsid(_id, `div`)\n        let x0 = this.na(x) ? NaN : (x.__id__ ? x[0] : x)\n        let y0 = this.na(y)? NaN : (y.__id__ ? y[0] : y)\n        return this.ts(x0 / y0, id, x.__tf__)\n    }\n\n    /** Returns a negative value / time-series\n     * @param {(TS|*)} x - Input\n     * @return {TS} - New time-series\n     */\n    neg(x, _id) {\n        let id = this._tsid(_id, `neg`)\n        let x0 = this.na(x) ? NaN : (x.__id__ ? x[0] : x)\n        return this.ts(-x0, id, x.__tf__)\n    }\n\n    /** Absolute value\n     * @param {number} x - Input\n     * @return {number} - Absolute value\n     */\n    abs(x) {\n        return Math.abs(x)\n    }\n\n    /** Arccosine function\n     * @param {number} x - Input\n     * @return {number} - Arccosine of x\n     */\n    acos(x) {\n        return Math.acos(x)\n    }\n\n    /** Emits an event to DataCube\n     * @param {string} type - Signal type\n     * @param {*} data - Signal data\n     */\n    signal(type, data = {}) {\n        if (this.se.shared.event !== 'update') return\n        this.se.send('script-signal', { type, data })\n    }\n\n    /** Emits an event if cond === true\n     * @param {(boolean|TS)} cond - The condition\n     * @param {string} type - Signal type\n     * @param {*} data - Signal data\n     */\n    signalif(cond, type, data = {}) {\n        if (this.se.shared.event !== 'update') return\n        if (cond && cond.__id__) cond = cond[0]\n        if (cond) {\n            this.se.send('script-signal', { type, data })\n        }\n    }\n\n    /** Arnaud Legoux Moving Average\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @param {number} offset - Offset\n     * @param {number} sigma - Sigma\n     * @return {TS} - New time-series\n     */\n    alma(src, len, offset, sigma, _id) {\n        let id = this._tsid(_id, `alma(${len},${offset},${sigma})`)\n        let m = Math.floor(offset * (len - 1))\n        let s = len / sigma\n        let norm = 0\n        let sum = 0\n        for (var i = 0; i < len; i++) {\n            let w = Math.exp(-1 * Math.pow(i - m, 2) / (2 * Math.pow(s, 2)))\n            norm = norm + w\n            sum = sum + src[len - i - 1] * w\n        }\n        return this.ts(sum / norm, id, src.__tf__)\n    }\n\n    /** Arcsine function\n     * @param {number} x - Input\n     * @return {number} - Arcsine of x\n     */\n    asin(x) {\n        return Math.asin(x)\n    }\n\n    /** Arctangent function\n     * @param {number} x - Input\n     * @return {number} - Arctangent of x\n     */\n    atan(x) {\n        return Math.atan(x)\n    }\n\n    /** Average True Range\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    atr(len, _id, _tf) {\n        let tfs = _tf || ''\n        let id = this._tsid(_id, `atr(${len})`)\n        let high = this.env.shared[`high${tfs}`]\n        let low = this.env.shared[`low${tfs}`]\n        let close = this.env.shared[`close${tfs}`]\n        let tr = this.ts(0, id, _tf)\n        tr[0] = this.na(high[1]) ? high[0] - low[0] :\n            Math.max(\n                Math.max(\n                    high[0] - low[0],\n                    Math.abs(high[0] - close[1])\n                ),\n                Math.abs(low[0] - close[1])\n            )\n        return this.rma(tr, len, id)\n    }\n\n    /** Average of arguments\n     * @param {...number} args - Numeric values\n     * @return {number}\n     */\n    avg(...args) {\n        args.pop() // Remove _id\n        let sum = 0\n        for (var i = 0; i < args.length; i++) {\n            sum += args[i]\n        }\n        return sum / args.length\n    }\n\n    /** Candles since the event occured (cond === true)\n     * @param {(boolean|TS)} cond - the condition\n     */\n    since(cond, _id) {\n        let id = this._tsid(_id, `since()`)\n        if (cond && cond.__id__) cond = cond[0]\n        let s = this.ts(undefined, id)\n        s[0] = cond ? 0 : s[1] + 1\n        return s\n    }\n\n    /** Bollinger Bands\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @param {number} mult - Multiplier\n     * @return {TS[]} - Array of new time-series (3 bands)\n     */\n    bb(src, len, mult, _id) {\n        let id = this._tsid(_id, `bb(${len},${mult})`)\n        let basis = this.sma(src, len, id)\n        let dev = this.stdev(src, len, id)[0] * mult\n        return [\n            basis,\n            this.ts(basis[0] + dev, id + '1', src.__tf__),\n            this.ts(basis[0] - dev, id + '2', src.__tf__)\n        ]\n    }\n\n    /** Bollinger Bands Width\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @param {number} mult - Multiplier\n     * @return {TS} - New time-series\n     */\n    bbw(src, len, mult, _id) {\n        let id = this._tsid(_id, `bbw(${len},${mult})`)\n        let basis = this.sma(src, len, id)[0]\n        let dev = this.stdev(src, len, id)[0] * mult\n        return this.ts(2 * dev / basis, id, src.__tf__)\n    }\n\n    /** Converts the variable to Boolean\n     * @param {number} x The variable\n     * @return {number}\n     */\n    bool(x) {\n        return !!x\n    }\n\n    /** Commodity Channel Index\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    cci(src, len, _id) {\n        // TODO: Not exactly precise, but pretty damn close\n        let id = this._tsid(_id, `cci(${len})`)\n        let ma = this.sma(src, len, id)\n        let dev = this.dev(src, len, id)\n        let cci = (src[0] - ma[0]) / (0.015 * dev[0])\n        return this.ts(cci, id, src.__tf__)\n    }\n\n    /** Shortcut for Math.ceil()\n     * @param {number} x The variable\n     * @return {number}\n     */\n    ceil(x) {\n        return Math.ceil(x)\n    }\n\n    /** Change: x[0] - x[len]\n     * @param {TS} src - Input\n     * @param {number} [len] - Length\n     * @return {TS} - New time-series\n     */\n    change(src, len = 1, _id) {\n        let id = this._tsid(_id, `change(${len})`)\n        return this.ts(src[0] - src[len], id, src.__tf__)\n    }\n\n    /** Chande Momentum Oscillator\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    cmo(src, len, _id) {\n        let id = this._tsid(_id, `cmo(${len})`)\n        let mom = this.change(src, 1, id)\n\n        let g = this.ts(mom[0] >= 0 ? mom[0] : 0.0, id+\"g\", src.__tf__)\n        let l = this.ts(mom[0] >= 0 ? 0.0 : -mom[0], id+\"l\", src.__tf__)\n\n        let sm1 = this.sum(g, len, id+'1')[0]\n        let sm2 = this.sum(l, len, id+'2')[0]\n\n        return this.ts(100 * (sm1 - sm2) / (sm1 + sm2), id, src.__tf__)\n    }\n\n    /** Center of Gravity\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    cog(src, len, _id) {\n        let id = this._tsid(_id, `cmo(${len})`)\n        let sum = this.sum(src, len, id)[0]\n        let num = 0\n        for (var i = 0; i < len; i++) {\n            num += src[i] * (i + 1)\n        }\n        return this.ts(-num / sum, id, src.__tf__)\n    }\n\n    // Correlation\n    corr() {\n        // TODO: this\n    }\n\n    /** Cosine function\n     * @param {number} x - Input\n     * @return {number} - Cosine of x\n     */\n    cos(x) {\n        return Math.cos(x)\n    }\n\n    /** When one time-series crosses another\n     * @param {TS} src1 - TS1\n     * @param {TS} src2 - TS2\n     * @return {TS} - New time-series\n     */\n    cross(src1, src2, _id) {\n        let id = this._tsid(_id, `cross`)\n        let x = (src1[0] > src2[0]) !== (src1[1] > src2[1])\n        return this.ts(x, id, src1.__tf__)\n    }\n\n    /** When one time-series goes over another one\n     * @param {TS} src1 - TS1\n     * @param {TS} src2 - TS2\n     * @return {TS} - New time-series\n     */\n    crossover(src1, src2, _id) {\n        let id = this._tsid(_id, `crossover`)\n        let x = (src1[0] > src2[0]) && (src1[1] <= src2[1])\n        return this.ts(x, id, src1.__tf__)\n    }\n\n    /** When one time-series goes under another one\n     * @param {TS} src1 - TS1\n     * @param {TS} src2 - TS2\n     * @return {TS} - New time-series\n     */\n    crossunder(src1, src2, _id) {\n        let id = this._tsid(_id, `crossunder`)\n        let x = (src1[0] < src2[0]) && (src1[1] >= src2[1])\n        return this.ts(x, id, src1.__tf__)\n    }\n\n    /** Sum of all elements of src\n     * @param {TS} src1 - Input\n     * @return {TS} - New time-series\n     */\n    cum(src, _id) {\n        let id = this._tsid(_id, `cum`)\n        let res = this.ts(0, id, src.__tf__)\n        res[0] = this.nz(src[0]) + this.nz(res[1])\n        return res\n    }\n\n    /** Day of month, literally\n     * @param {number} [time] - Time in ms (current t, if not defined)\n     * @return {number} - Day\n     */\n    dayofmonth(time) {\n        return new Date(time || se.t).getUTCDate()\n    }\n\n    /** Day of week, literally\n     * @param {number} [time] - Time in ms (current t, if not defined)\n     * @return {number} - Day\n     */\n    dayofweek(time) {\n        return new Date(time || se.t).getUTCDay() + 1\n    }\n\n    /** Deviation from SMA\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    dev(src, len, _id) {\n        let id = this._tsid(_id, `dev(${len})`)\n        let mean = this.sma(src, len, id)[0]\n        let sum = 0\n        for (var i = 0; i < len; i++) {\n            sum += Math.abs(src[i] - mean)\n        }\n        return this.ts(sum / len, id, src.__tf__)\n    }\n\n    /** Directional Movement Index ADX, +DI, -DI\n     * @param {number} len - Length\n     * @param {number} smooth - Smoothness\n     * @return {TS} - New time-series\n     */\n    dmi(len, smooth, _id, _tf) {\n        let id = this._tsid(_id, `dmi(${len},${smooth})`)\n        let tfs = _tf || ''\n        let high = this.env.shared[`high${tfs}`]\n        let low = this.env.shared[`low${tfs}`]\n        let up = this.change(high, 1, id+'1')[0]\n        let down = this.neg(this.change(low, 1, id+'2'), id)[0]\n\n        let plusDM = this.ts(100 * (\n            this.na(up) ? NaN :\n            (up > down && up > 0 ? up : 0)), id+'3', _tf\n        )\n        let minusDM = this.ts(100 * (\n            this.na(down) ? NaN :\n            (down > up && down > 0 ? down : 0)), id+'4', _tf\n        )\n\n        let trur = this.rma(this.tr(false, id, _tf), len, id+'5')\n        let plus = this.div(\n            this.rma(plusDM, len, id+'6'), trur, id+'8')\n        let minus = this.div(\n            this.rma(minusDM, len, id+'7'), trur, id+'9')\n        let sum = this.add(plus, minus, id+'10')[0]\n        let adx = this.rma(\n            this.ts(100 * Math.abs(plus[0] - minus[0]) /\n            (sum === 0 ? 1 : sum), id+'11', _tf),\n            smooth, id+'12'\n        )\n        return [adx, plus, minus]\n    }\n\n    /** Exponential Moving Average with alpha = 2 / (y + 1)\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    ema(src, len, _id) {\n        let id = this._tsid(_id, `ema(${len})`)\n        let a = 2 / (len + 1)\n        let ema = this.ts(0, id, src.__tf__)\n        ema[0] = this.na(ema[1]) ?\n            this.sma(src, len, id)[0] :\n            a * src[0] + (1 - a) * this.nz(ema[1])\n        return ema\n    }\n\n    /** Shortcut for Math.exp()\n     * @param {number} x The variable\n     * @return {number}\n     */\n    exp(x) {\n        return Math.exp(x)\n    }\n\n    /** Test if \"src\" TS is falling for \"len\" candles\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    falling(src, len, _id) {\n        let id = this._tsid(_id, `falling(${len})`)\n        let bot = src[0]\n        for (var i = 1; i < len + 1; i++) {\n            if (bot >= src[i]) {\n                return this.ts(false, id, src.__tf__)\n            }\n        }\n        return this.ts(true, id, src.__tf__)\n    }\n\n    /** For a given series replaces NaN values with\n     * previous nearest non-NaN value\n     * @param {TS} src - Input time-series\n     * @return {TS}\n     */\n    fixnan(src) {\n        if (this.na(src[0])) {\n            for (var i = 1; i < src.length; i++) {\n                if (!this.na(src[i])) {\n                    src[0] = src[i]\n                    break\n                }\n            }\n        }\n        return src\n    }\n\n    /* TODO: think\n    skipnan(x, _id) {\n        let id = this._tsid(_id, `skipnan()`)\n        return this.ts(true, id, src.__tf__)\n    }*/\n\n    /** Shortcut for Math.floor()\n     * @param {number} x The variable\n     * @return {number}\n     */\n    floor(x) {\n        Math.floor(x)\n    }\n\n    /** Highest value for a given number of candles back\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    highest(src, len, _id) {\n        let id = this._tsid(_id, `highest(${len})`)\n        let high = -Infinity\n        for (var i = 0; i < len; i++) {\n            if (src[i] > high) high = src[i]\n        }\n        return this.ts(high, id, src.__tf__)\n    }\n\n    /** Highest value offset for a given number of bars back\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     */\n    highestbars(src, len, _id) {\n        let id = this._tsid(_id, `highestbars(${len})`)\n        let high = -Infinity\n        let hi = 0\n        for (var i = 0; i < len; i++) {\n            if (src[i] > high) { high = src[i], hi = i }\n        }\n        return this.ts(-hi, id, src.__tf__)\n    }\n\n    /** Hull Moving Average\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    hma(src, len, _id) {\n        let id = this._tsid(_id, `hma(${len})`)\n        let len2 = Math.floor(len/2)\n        let len3 = Math.round(Math.sqrt(len))\n\n        let a = this.mult(this.wma(src, len2, id+'1'), 2, id)\n        let b = this.wma(src, len, id+'2')\n        let delt = this.sub(a, b, id+'3')\n\n        return this.wma(delt, len3, id+'4')\n    }\n\n    /** Returns hours of a given timestamp\n     * @param {number} [time] - Time in ms (current t, if not defined)\n     * @return {number} - Hour\n     */\n    hour(time) {\n        return new Date(time || se.t).getUTCHours()\n    }\n\n    /** Returns x or y depending on the condition\n     * @param {(boolean|TS)} cond - Condition\n     * @param {*} x - Frist value\n     * @param {*} y - Second value\n     * @return {*}\n     */\n    iff(cond, x, y) {\n        if (cond && cond.__id__) cond = cond[0]\n        return cond ? x : y\n    }\n\n    /** Keltner Channels\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @param {number} mult - Multiplier\n     * @param {boolean} [use_tr] - Use true range\n     * @return {TS[]} - Array of new time-series (3 bands)\n     */\n    kc(src, len, mult, use_tr = true, _id, _tf) {\n\n        let id = this._tsid(_id, `kc(${len},${mult},${use_tr})`)\n        let tfs = _tf || ''\n        let high = this.env.shared[`high${tfs}`]\n        let low = this.env.shared[`low${tfs}`]\n        let basis = this.ema(src, len, id+'1')\n\n        let range = use_tr ?\n            this.tr(false, id+'2', _tf) :\n            this.ts(high[0] - low[0], id+'3', src.__tf__)\n        let ema = this.ema(range, len, id+'4')\n\n        return [\n            basis,\n            this.ts(basis[0] + ema[0] * mult, id+'5', src.__tf__),\n            this.ts(basis[0] - ema[0] * mult, id+'6', src.__tf__)\n        ]\n    }\n\n    /** Keltner Channels Width\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @param {number} mult - Multiplier\n     * @param {boolean} [use_tr] - Use true range\n     * @return {TS} - New time-series\n     */\n    kcw(src, len, mult, use_tr = true, _id, _tf) {\n        let id = this._tsid(_id, `kcw(${len},${mult},${use_tr})`)\n        let kc = this.kc(src, len, mult, use_tr, `kcw`, _tf)\n        return this.ts((kc[1][0] - kc[2][0]) / kc[0][0], id, src.__tf__)\n    }\n\n    /** Linear Regression\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @param {number} offset - Offset\n     * @return {TS} - New time-series\n     */\n    linreg(src, len, offset = 0, _id) {\n        let id = this._tsid(_id, `linreg(${len})`)\n\n        src.__len__ = Math.max(src.__len__ || 0, len)\n        let lr = linreg(src, len, offset)\n\n        return this.ts(lr, id, src.__tf__)\n    }\n\n    /** Shortcut for Math.log()\n     * @param {number} x The variable\n     * @return {number}\n     */\n    log(x) {\n        return Math.log(x)\n    }\n\n    /** Shortcut for Math.log10()\n     * @param {number} x The variable\n     * @return {number}\n     */\n    log10(x) {\n        return Math.log10(x)\n    }\n\n    /** Lowest value for a given number of candles back\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    lowest(src, len, _id) {\n        let id = this._tsid(_id, `lowest(${len})`)\n        let low = Infinity\n        for (var i = 0; i < len; i++) {\n            if (src[i] < low) low = src[i]\n        }\n        return this.ts(low, id, src.__tf__)\n    }\n\n    /** Lowest value offset for a given number of bars back\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     */\n    lowestbars(src, len, _id) {\n        let id = this._tsid(_id, `lowestbars(${len})`)\n        let low = Infinity\n        let li = 0\n        for (var i = 0; i < len; i++) {\n            if (src[i] < low) { low = src[i], li = i }\n        }\n        return this.ts(-li, id, src.__tf__)\n    }\n\n    /** Moving Average Convergence/Divergence\n     * @param {TS} src - Input\n     * @param {number} fast - Fast EMA\n     * @param {number} slow - Slow EMA\n     * @param {number} sig - Signal\n     * @return {TS[]} - [macd, signal, hist]\n     */\n    macd(src, fast, slow, sig, _id) {\n        let id = this._tsid(_id, `macd(${fast}${slow}${sig})`)\n        let fast_ma = this.ema(src, fast, id+'1')\n        let slow_ma = this.ema(src, slow, id+'2')\n        let macd = this.sub(fast_ma, slow_ma, id+'3')\n        let signal = this.ema(macd, sig, id+'4')\n        let hist = this.sub(macd, signal, id+'5')\n        return [macd, signal, hist]\n    }\n\n    /** Max of arguments\n     * @param {...number} args - Numeric values\n     * @return {number}\n     */\n    max(...args) {\n        args.pop() // Remove _id\n        return Math.max(...args)\n    }\n\n    /** Sends update to some overlay / main chart\n     * @param {string} id - Overlay id\n     * @param {Object} fields - Fields to be overwritten\n     */\n    modify(id, fields) {\n        se.send('modify-overlay', { uuid:id, fields })\n    }\n\n    /** Sets the reverse buffer size for a given\n     * time-series (default = 5, grows on demand)\n     * @param {TS} src - Input\n     * @param {number} len - New length\n     */\n    buffsize(src, len) {\n        src.__len__ = len\n    }\n\n    /** Money Flow Index\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    mfi(src, len, _id) {\n        let id = this._tsid(_id, `mfi(${len})`)\n        let vol = this.env.shared.vol\n        let ch = this.change(src, 1, id+'1')[0]\n\n        let ts1 = this.mult(vol, ch <= 0.0 ? 0.0 : src[0], id+'2')\n        let ts2 = this.mult(vol, ch  >= 0.0 ? 0.0 : src[0], id+'3')\n\n        let upper = this.sum(ts1, len, id+'4')\n        let lower = this.sum(ts2, len, id+'5')\n\n        let res = undefined\n        if (!this.na(lower)) {\n            res = this.rsi(upper, lower, id+'6')[0]\n        }\n        return this.ts(res, id, src.__tf__)\n    }\n\n    /** Min of arguments\n     * @param {...number} args - Numeric values\n     * @return {number}\n     */\n    min(...args) {\n        args.pop() // Remove _id\n        return Math.min(...args)\n    }\n\n    /** Returns minutes of a given timestamp\n     * @param {number} [time] - Time in ms (current t, if not defined)\n     * @return {number} - Hour\n     */\n    minute(time) {\n        return new Date(time || se.t).getUTCMinutes()\n    }\n\n    /** Momentum\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    mom(src, len, _id) {\n        let id = this._tsid(_id, `mom(${len})`)\n        return this.ts(src[0] - src[len], id, src.__tf__)\n    }\n\n    /** Month\n     * @param {number} [time] - Time in ms (current t, if not defined)\n     * @return {number} - Day\n     */\n    month(time) {\n        return new Date(time || se.t).getUTCMonth()\n    }\n\n    // Display data point as the main chart\n    chart() {\n        // TODO: this\n    }\n\n    // TODO: optionally enable scripts for $synth ovs\n    // TODO: add indexBased option\n    /** Display data point onchart\n     * (create a new overlay in DataCube)\n     * @param {(TS|TS[]|*)} x - Data point / TS / array of TS\n     * @param {string} [name] - Overlay name\n     * @param {Object} [sett] - Object with settings & OV type\n     */\n    onchart(x, name, sett = {}, _id) {\n        let off = 0\n        name = name || u.get_fn_id('Onchart', _id)\n        if (x && x.__id__) {\n            off = x.__offset__ || 0\n            x = x[0]\n        }\n        if (Array.isArray(x) && x[0] && x[0].__id__) {\n            off = x[0].__offset__ || 0\n            x = x.map(x => x[0])\n        }\n        if (!this.env.onchart[name]) {\n            let type = sett.type\n            delete sett.type\n            sett.$synth = true\n            sett.skipNaN = true\n            let post = Array.isArray(x) ? 's': ''\n            this.env.onchart[name] = {\n                name: name,\n                type: type || 'Spline' + post,\n                data: [],\n                settings: sett,\n                scripts: false,\n                grid: sett.grid || {}\n            }\n        }\n        off *= se.tf\n        let v = Array.isArray(x) ?\n            [se.t + off, ...x] : [se.t + off, x]\n        u.update(this.env.onchart[name].data, v)\n    }\n\n    /** Display data point offchart\n     * (create a new overlay in DataCube)\n     * @param {(TS|TS[]|*)} x - Data point / TS / array of TS\n     * @param {string} [name] - Overlay name\n     * @param {Object} [sett] - Object with settings & OV type\n     */\n    offchart(x, name, sett = {}, _id) {\n        name = name || u.get_fn_id('Offchart', _id)\n        let off = 0\n        if (x && x.__id__) {\n            off = x.__offset__ || 0\n            x = x[0]\n        }\n        if (Array.isArray(x) && x[0] && x[0].__id__) {\n            off = x[0].__offset__ || 0\n            x = x.map(x => x[0])\n        }\n        if (!this.env.offchart[name]) {\n            let type = sett.type\n            delete sett.type\n            sett.$synth = true\n            sett.skipNaN = true\n            let post = Array.isArray(x) ? 's': ''\n            this.env.offchart[name] = {\n                name: name,\n                type: type || 'Spline' + post,\n                data: [],\n                settings: sett,\n                scripts: false,\n                grid: sett.grid || {}\n            }\n        }\n        off *= se.tf\n        let v = Array.isArray(x) ?\n            [se.t + off, ...x] : [se.t + off, x]\n        u.update(this.env.offchart[name].data, v)\n    }\n\n\n    /** Returns true when the candle(<tf>) is being closed\n     * (create a new overlay in DataCube)\n     * @param {(number|string)} tf - Timeframe in ms or as a string\n     * @return {boolean}\n     */\n    onclose(tf) {\n        if (!this.env.shared.onclose) return false\n        if (!tf) tf = se.tf\n        return (se.t + se.tf) % u.tf_from_str(tf) === 0\n    }\n\n    /** Sends settings update\n     * (can be called from init(), update() or post())\n     * @param {Object} upd - Settings update (object to merge)\n     */\n    settings(upd) {\n        this.env.send_modify({ settings: upd })\n        Object.assign(this.env.src.sett, upd)\n    }\n\n    /** Shifts TS left or right by \"num\" candles\n     * @param {number} num - Offset measured in candles\n     * @return {TS} - New / existing time-series\n     */\n    offset(src, num, _id) {\n        if (src.__id__) {\n            src.__offset__ = num\n            return src\n        }\n        let id = this._tsid(_id, `offset(${num})`)\n        let out = ts(src, id)\n        out.__offset__ = num\n        return out\n    }\n\n    // percentile_linear_interpolation\n    linearint() {\n        // TODO: this\n    }\n\n    // percentile_nearest_rank\n    nearestrank() {\n        // TODO: this\n    }\n\n    /** The current time\n     * @return {number} - timestamp\n     */\n    now() {\n        return new Date().getTime()\n    }\n\n    percentrank() {\n        // TODO: this\n    }\n\n    /** Returns price of the pivot high point\n     * Tip: works best with `offset` function\n     * @param {TS} src - Input\n     * @param {number} left - left threshold, candles\n     * @param {number} right - right threshold, candles\n     * @return {TS} - New time-series\n     */\n    pivothigh(src, left, right, _id) {\n        let id = this._tsid(_id, `pivothigh(${left},${right})`)\n\n        let len = left + right + 1\n        let top = src[right]\n        for (var i = 0; i < len; i++) {\n            if (top <= src[i] && i !== right) {\n                return this.ts(NaN, id, src.__tf__)\n            }\n        }\n        return this.ts(top, id, src.__tf__)\n    }\n\n    /** Returns price of the pivot low point\n     * Tip: works best with `offset` function\n     * @param {TS} src - Input\n     * @param {number} left - left threshold, candles\n     * @param {number} right - right threshold, candles\n     * @return {TS} - New time-series\n     */\n    pivotlow(src, left, right, _id) {\n        let id = this._tsid(_id, `pivotlow(${left},${right})`)\n\n        let len = left + right + 1\n        let bot = src[right]\n        for (var i = 0; i < len; i++) {\n            if (bot >= src[i] && i !== right) {\n                return this.ts(NaN, id, src.__tf__)\n            }\n        }\n        return this.ts(bot, id, src.__tf__)\n    }\n\n    /** Shortcut for Math.pow()\n     * @param {number} x The variable\n     * @return {number}\n     */\n    pow(x) {\n        return Math.pow(x)\n    }\n\n    /** Test if \"src\" TS is rising for \"len\" candles\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    rising(src, len, _id) {\n        let id = this._tsid(_id, `rising(${len})`)\n        let top = src[0]\n        for (var i = 1; i < len + 1; i++) {\n            if (top <= src[i]) {\n                return this.ts(false, id, src.__tf__)\n            }\n        }\n        return this.ts(true, id, src.__tf__)\n    }\n\n    /** Exponentially MA with alpha = 1 / length\n     * Used in RSI\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    rma(src, len, _id) {\n        let id = this._tsid(_id, `rma(${len})`)\n        let a = len\n        let sum = this.ts(0, id, src.__tf__)\n        sum[0] = this.na(sum[1]) ?\n            this.sma(src, len, id)[0] :\n            (src[0] + (a - 1) * this.nz(sum[1])) / a\n        return sum\n    }\n\n    /** Rate of Change\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    roc(src, len, _id) {\n        let id = this._tsid(_id, `roc(${len})`)\n        return this.ts(\n            100 * (src[0] - src[len]) / src[len], id, src.__tf__\n        )\n    }\n\n    /** Shortcut for Math.round()\n     * @param {number} x The variable\n     * @return {number}\n     */\n    round(x) {\n        return Math.round(x)\n    }\n\n    /** Relative Strength Index\n     * @param {TS} x - First Input\n     * @param {number|TS} y - Second Input\n     * @return {TS} - New time-series\n     */\n    rsi(x, y, _id) {\n        // Check if y is a timeseries\n        if (!this.na(y) && y.__id__) {\n            var id = this._tsid(_id, `rsi(x,y)`)\n            var rsi = 100 - 100 / (1 + this.div(x, y, id)[0])\n        } else {\n            var id = this._tsid(_id, `rsi(${y})`)\n            let ch = this.change(x, 1, _id)[0]\n            let pc = this.ts(Math.max(ch, 0), id+'1', x.__tf__)\n            let nc = this.ts(-Math.min(ch, 0), id+'2', x.__tf__)\n            let up = this.rma(pc, y, id+'3')[0]\n            let down = this.rma(nc, y, id+'4')[0]\n            var rsi = down === 0 ? 100 : (\n                up === 0 ? 0 : (100 - (100 / (1 + up / down)))\n            )\n        }\n        return this.ts(rsi, id+'5', x.__tf__)\n    }\n\n    /** Parabolic SAR\n     * @param {number} start - Start\n     * @param {number} inc - Increment\n     * @param {number} max - Maximum\n     * @return {TS} - New time-series\n     */\n    sar(start, inc, max, _id, _tf) {\n        // Source: Parabolic SAR by imuradyan\n        // TODO: simplify the code\n        // TODO: fix the custom TF mode\n        let id = this._tsid(_id, `sar(${start},${inc},${max})`)\n        let tfs = _tf || ''\n        let high = this.env.shared[`high${tfs}`]\n        let low = this.env.shared[`low${tfs}`]\n        let close = this.env.shared[`close${tfs}`]\n\n        let minTick = 0 //1e-7\n        let out = this.ts(undefined, id+'1', _tf)\n        let pos = this.ts(undefined, id+'2', _tf)\n        let maxMin = this.ts(undefined, id+'3', _tf)\n        let acc = this.ts(undefined, id+'4', _tf)\n        let n = _tf ? out.__len__ - 1 : se.iter\n        let prev\n        let outSet = false\n\n        if (n >= 1) {\n            prev = out[1]\n            if (n === 1) {\n                if (close[0] > close[1]) {\n                    pos[0] = 1\n                    maxMin[0] = Math.max(high[0], high[1])\n                    prev = Math.min(low[0], low[1])\n                } else {\n                    pos[0] = -1\n                    maxMin[0] = Math.min(low[0], low[1])\n                    prev = Math.max(high[0], high[1])\n                }\n                acc[0] = start\n            } else {\n                pos[0] = pos[1]\n                acc[0] = acc[1]\n                maxMin[0] = maxMin[1]\n            }\n            if (pos[0] === 1) {\n                if (high[0] > maxMin[0]) {\n                    maxMin[0] = high[0]\n                    acc[0] = Math.min(acc[0] + inc, max)\n                }\n                if (low[0] <= prev) {\n                    pos[0] = -1\n                    out[0] = maxMin[0]\n                    maxMin[0] = low[0]\n                    acc[0] = start\n                    outSet = true\n                }\n            } else {\n                if (low[0] < maxMin[0]) {\n                    maxMin[0] = low[0]\n                    acc[0] = Math.min(acc[0] + inc, max)\n                }\n\n                if (high[0] >= prev) {\n                    pos[0] = 1\n                    out[0] = maxMin[0]\n                    maxMin[0] = high[0]\n                    acc[0] = start\n                    outSet = true\n                }\n            }\n\n            if (!outSet) {\n                out[0] = prev + acc[0] * (maxMin[0] - prev)\n\n                if (pos[0] === 1)\n                    if (out[0] >= low[0])\n                        out[0] = low[0] - minTick\n\n\n                if (pos[0] === -1)\n                    if (out[0] <= high[0])\n                        out[0] = high[0] + minTick\n            }\n        }\n        return out\n    }\n\n    /** Returns seconds of a given timestamp\n     * @param {number} [time] - Time in ms (current t, if not defined)\n     * @return {number} - Hour\n     */\n    second(time) {\n        return new Date(time || se.t).getUTCSeconds()\n    }\n\n    /** Shortcut for Math.sing()\n     * @param {number} x The variable\n     * @return {number}\n     */\n    sign(x) {\n        return Math.sign(x)\n    }\n\n    /** Sine function\n     * @param {number} x The variable\n     * @return {number}\n     */\n    sin(x) {\n        return Math.sin(x)\n    }\n\n    /** Simple Moving Average\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    sma(src, len, _id) {\n        let id = this._tsid(_id, `sma(${len})`)\n        let sum = 0\n        for (var i = 0; i < len; i++) {\n            sum = sum + src[i]\n        }\n        return this.ts(sum / len, id, src.__tf__)\n    }\n\n    /** Shortcut for Math.sqrt()\n     * @param {number} x The variable\n     * @return {number}\n     */\n    sqrt(x) {\n        return Math.sqrt(x)\n    }\n\n    /** Standard deviation\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    stdev(src, len, _id) {\n\n        let sumf = (x, y) => {\n            let res = x + y\n            return res\n        }\n\n        let id = this._tsid(_id, `stdev(${len})`)\n        let avg = this.sma(src, len, id)\n        let sqd = 0\n        for (var i = 0; i < len; i++) {\n            let sum = sumf(src[i], -avg[0])\n            sqd += sum * sum\n        }\n        return this.ts(Math.sqrt(sqd / len), id, src.__tf__)\n    }\n\n    /** Stochastic\n     * @param {TS} src - Input\n     * @param {TS} high - TS of high\n     * @param {TS} low - TS of low\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    stoch(src, high, low, len, _id) {\n        let id = this._tsid(_id, `sum(${len})`)\n        let x = 100 * (src[0] - this.lowest(low, len)[0])\n        let y = this.highest(high, len)[0] - this.lowest(low, len)[0]\n        return this.ts(x / y, id, src.__tf__)\n    }\n\n    /** Returns the sliding sum of last \"len\" values of the source\n     * @param {TS} src - Input\n     * @param {number} len - Length\n     * @return {TS} - New time-series\n     */\n    sum(src, len, _id) {\n        let id = this._tsid(_id, `sum(${len})`)\n        let sum = 0\n        for (var i = 0; i < len; i++) {\n            sum = sum + src[i]\n        }\n        return this.ts(sum, id, src.__tf__)\n    }\n\n    /** Supertrend Indicator\n     * @param {number} factor - ATR multiplier\n     * @param {number} atrlen - Length of ATR\n     * @return {TS[]} - Supertrend line and direction of trend\n     */\n    supertrend(factor, atrlen, _id, _tf) {\n        let id = this._tsid(_id, `supertrend(${factor},${atrlen})`)\n        let tfs = _tf || ''\n        let high = this.env.shared[`high${tfs}`]\n        let low = this.env.shared[`low${tfs}`]\n        let close = this.env.shared[`close${tfs}`]\n        let hl2 = (high[0] + low[0]) * 0.5\n\n        let atr = factor * this.atr(atrlen, id+'1', _tf)[0]\n\n        let ls = this.ts(hl2 - atr, id+'2', _tf)\n        let ls1 = this.nz(ls[1], ls[0])\n        ls[0] = close[1] > ls1 ? Math.max(ls[0], ls1) : ls[0]\n\n        let ss = this.ts(hl2 + atr, id+'3', _tf)\n        let ss1 = this.nz(ss[1], ss)\n        ss[0] = close[1] < ss1 ? Math.min(ss[0], ss1) : ss[0]\n\n        let dir = this.ts(1, id+'4', _tf)\n        dir[0] = this.nz(dir[1], dir[0])\n        dir[0] = dir[0] === -1 && close[0] > ss1 ? 1 :\n            (dir[0] === 1 && close[0] < ls1 ? -1 : dir[0])\n\n        let plot = this.ts(dir[0] === 1 ? ls[0] : ss[0], id+'5', _tf)\n        return [plot, this.neg(dir, id+'6')]\n    }\n\n    /** Symmetrically Weighted Moving Average\n     * @param {TS} src - Input\n     * @return {TS} - New time-series\n     */\n    swma(src, _id) {\n        let id = this._tsid(_id, `swma`)\n        let sum = src[3] * this.SWMA[0] + src[2] * this.SWMA[1] +\n                  src[1] * this.SWMA[2] + src[0] * this.SWMA[3]\n        return this.ts(sum, id, src.__tf__)\n    }\n\n    /** Creates a new Symbol.\n     * @param {*} x - Something, depends on arg variation\n     * @param {*} y - Something, depends on arg variation\n     * @return {Sym}\n     * Argument variations:\n     * <data>(Array), [<params>(Object)]\n     * <ts>(TS), [<params>(Object)]\n     * <point>(Number), [<params>(Object)]\n     * <tf>(String) 1m, 5m, 1H, etc. (uses main OHLCV)\n     * Params object: {\n     *  id: <String>,\n     *  tf: <String|Number>,\n     *  aggtype: <String> (TODO: Type of aggregation)\n     *  format: <String> (Data format, e.g. \"time:price:vol\")\n     *  window: <String|Number> (Aggregation window)\n     *  main <true|false> (Use as the main chart)\n     * }\n     */\n    sym(x, y = {}, _id) {\n        let id = y.id || this._tsid(_id, `sym`)\n        y.id = id\n        if (this.env.syms[id]) {\n            this.env.syms[id].update(x)\n            return this.env.syms[id]\n        }\n\n        switch(typeof x) {\n            case 'object':\n                var sym = new Sym(x, y)\n                this.env.syms[id] = sym\n                if (x.__id__) {\n                    sym.data_type = TSS\n                } else {\n                    sym.data_type = ARR\n                }\n\n                break\n            case 'number':\n                sym = new Sym(null, y)\n                sym.data_type = NUM\n                break\n            case 'string':\n                y.tf = x\n                sym = new Sym(se.data.ohlcv.data, y)\n                sym.data_type = ARR\n                break\n        }\n\n        this.env.syms[id] = sym\n        return sym\n    }\n\n    /** Tangent function\n     * @param {number} x The variable\n     * @return {number}\n     */\n    tan(x) {\n        return Math.tan(x)\n    }\n\n    time(res, sesh) {\n        // TODO: this\n    }\n\n    timestamp() {\n        // TODO: this\n    }\n\n    /** True Range\n     * @param {TS} fixnan - Fix NaN values\n     * @return {TS} - New time-series\n     */\n    tr(fixnan = false, _id, _tf) {\n        let id = this._tsid(_id, `tr(${fixnan})`)\n        let tfs = _tf || ''\n        let high = this.env.shared[`high${tfs}`]\n        let low = this.env.shared[`low${tfs}`]\n        let close = this.env.shared[`close${tfs}`]\n        let res = 0\n        if (this.na(close[1]) && fixnan) {\n            res = high[0] - low[0]\n        } else {\n            res = Math.max(\n                high[0] - low[0],\n                Math.abs(high[0] - close[1]),\n                Math.abs(low[0] - close[1])\n            )\n        }\n\n        return this.ts(res, id, _tf)\n\n    }\n\n    /** True strength index\n     * @param {TS} src - Input\n     * @param {number} short - Short length\n     * @param {number} long - Long length\n     * @return {TS} - New time-series\n     */\n    tsi(src, short, long, _id) {\n        let id = this._tsid(_id, `tsi(${short},${long})`)\n        let m = this.change(src, 1, id+'0')\n        let m_abs = this.ts(Math.abs(m[0]), id+'1', src.__tf__)\n        let tsi = (\n            this.ema(this.ema(m, long, id+'1'), short, id+'2')[0] /\n            this.ema(this.ema(m_abs, long, id+'3'), short, id+'4')[0]\n        )\n        return this.ts(tsi, id, src.__tf__)\n    }\n\n    variance(src, len) {\n        // TODO: this\n    }\n\n    vwap(src) {\n        // TODO: this\n    }\n\n    /** Volume Weighted Moving Average\n     * @param {TS} src - Input\n     * @param {number} len - length\n     * @return {TS} - New time-series\n     */\n    vwma(src, len, _id) {\n        let id = this._tsid(_id, `vwma(${len})`)\n        let vol = this.env.shared.vol\n        let sxv = this.ts(src[0] * vol[0], id+'1', src.__tf__)\n        let res =\n            this.sma(sxv, len, id+'2')[0] /\n            this.sma(vol, len, id+'3')[0]\n        return this.ts(res, id+'4', src.__tf__)\n    }\n\n    /** Week of year, literally\n     * @param {number} [time] - Time in ms (current t, if not defined)\n     * @return {number} - Week\n     */\n    weekofyear(time) {\n        let date = new Date(time || se.t)\n        date.setUTCHours(0, 0, 0, 0)\n        date.setDate(date.getUTCDate() + 3 - (date.getUTCDay() + 6) % 7)\n        let week1 = new Date(date.getUTCFullYear(), 0, 4)\n        return 1 + Math.round(\n            ((date - week1) / 86400000 - 3 +\n            (week1.getUTCDay() + 6) % 7) / 7\n        )\n    }\n\n    /** Weighted moving average\n     * @param {TS} src - Input\n     * @param {number} len - length\n     * @return {TS} - New time-series\n     */\n    wma(src, len, _id) {\n        let id = this._tsid(_id, `wma(${len})`)\n        let norm = 0\n        let sum = 0\n        for (var i = 0; i < len; i++) {\n            let w = (len - i) * len\n            norm += w\n            sum += src[i] * w\n        }\n        return this.ts(sum / norm, id, src.__tf__)\n    }\n\n    /** Williams %R\n     * @param {number} len - length\n     * @return {TS} - New time-series\n     */\n    wpr(len, _id, _tf) {\n        let id = this._tsid(_id, `wpr(${len})`)\n        let tfs = _tf || ''\n        let high = this.env.shared[`high${tfs}`]\n        let low = this.env.shared[`low${tfs}`]\n        let close = this.env.shared[`close${tfs}`]\n\n        let hh = this.highest(high, len, id)\n        let ll = this.lowest(low, len, id)\n\n        let res = (hh[0] - close[0]) / (hh[0] - ll[0])\n        return this.ts(-res * 100 , id, _tf)\n    }\n\n    /** Year\n     * @param {number} [time] - Time in ms (current t, if not defined)\n     * @return {number} - Year\n     */\n    year(time) {\n        return new Date(time || se.t).getUTCFullYear()\n    }\n\n}\n","\n// Timeseries for scripts\n\nexport default function TS(id, arr, len) {\n    arr.__id__ = id\n    arr.__len__ = len\n    return arr\n}\n","\nimport Const from '../stuff/constants.js'\n\nconst FDEFS = /(function |)([$A-Z_][0-9A-Z_$\\.]*)[\\s]*?\\((.*?)\\)/gmi\nconst SBRACKETS = /([$A-Z_][0-9A-Z_$\\.]*)[\\s]*?\\[([^\"^\\[^\\]]+?)\\]/gmi\nconst TFSTR = /(\\d+)(\\w*)/gm\n\nconst BUF_INC = 5\nvar tf_cache = {}\n\nexport function f_args(src) {\n    FDEFS.lastIndex = 0\n\n    var m = FDEFS.exec(src)\n    if (m) {\n        let fkeyword = m[1].trim()\n        let fname = m[2].trim()\n        let fargs = m[3].trim()\n\n        return fargs.split(',').map(x => x.trim())\n    }\n    return []\n}\nexport function f_body(src) {\n    return src.slice(\n        src.indexOf(\"{\") + 1,\n        src.lastIndexOf(\"}\")\n    )\n}\n\nexport function wrap_idxs(src, pre = '') {\n\n    SBRACKETS.lastIndex = 0\n    let changed = false\n\n    do {\n        var m = SBRACKETS.exec(src)\n\n        if (m) {\n\n            let vname = m[1].trim()\n            let vindex = m[2].trim()\n            if (vindex === '0' || parseInt(vindex) < BUF_INC) {\n                continue\n            }\n            switch(vname) {\n                case 'let':\n                case 'var':\n                case 'return':\n                    continue\n            }\n\n            //let wrap = `${pre}_v(${vname}, ${vindex})[${vindex}]`\n            let wrap = `${vname}[${pre}_i(${vindex}, ${vname})]`\n            src = src.replace(m[0], wrap)\n            changed = true\n        }\n    } while (m)\n\n    return changed ? src : src\n}\n\n// Get all module helper classes\nexport function make_module_lib(mod) {\n    let lib = {}\n    for (var k in mod) {\n        if (k === 'main' || k === 'id') continue\n        let a = f_args(mod[k])\n        lib[k] = new Function(a, f_body(mod[k]))\n    }\n    return lib\n}\n\nexport function get_raw_src(f) {\n    if (typeof f === 'string') return f\n    let src = f.toString()\n    return src.slice(\n        src.indexOf(\"{\") + 1,\n        src.lastIndexOf(\"}\")\n    )\n}\n\n// Get tf in ms from pairs such (`15`, `m`)\nexport function tf_from_pair(num, pf) {\n    var mult = 1\n    switch (pf) {\n        case 's': mult = Const.SECOND; break\n        case 'm': mult = Const.MINUTE; break\n        case 'H': mult = Const.HOUR; break\n        case 'D': mult = Const.DAY; break\n        case 'W': mult = Const.WEEK; break\n        case 'M': mult = Const.MONTH; break\n        case 'Y': mult = Const.YEAR; break\n    }\n    return parseInt(num) * mult\n}\n\nexport function tf_from_str(str) {\n\n    if (typeof str === 'number') return str\n    if (tf_cache[str]) return tf_cache[str]\n\n    TFSTR.lastIndex = 0\n    let m = TFSTR.exec(str)\n    if (m) {\n        tf_cache[str] = tf_from_pair(m[1], m[2])\n        return tf_cache[str]\n    }\n    return undefined\n}\n\nexport function get_fn_id(pre, id) {\n    return pre + '-' + id.split('<-').pop()\n}\n\n// Apply filter for all new overlays\nexport function ovf(obj, f) {\n    var nw = {}\n    for (var id in obj) {\n        nw[id] = {}\n        for (var k in obj[id]) {\n            if (k === 'data') continue\n            nw[id][k] = obj[id][k]\n        }\n        nw[id].data = f(obj[id].data)\n    }\n    return nw\n}\n\n// Return index of the next element in\n// dataset (since t). Impl: simple binary search\n// TODO: optimize (remember the penultimate\n// iteration and start from there)\nexport function nextt(data, t, ti = 0) {\n\n    let i0 = 0\n    let iN = data.length - 1\n\n    while (i0 <= iN) {\n        var mid = Math.floor((i0 + iN) / 2)\n        if (data[mid][ti] === t) {\n            return mid\n        } else if (data[mid][ti] < t) {\n            i0 = mid + 1\n        } else {\n            iN = mid - 1\n        }\n    }\n\n    return t < data[mid][ti] ? mid : mid + 1\n\n}\n\n// Estimated size of datasets\nexport function size_of_dss(data) {\n    let bytes = 0\n    for (var id in data) {\n        if (data[id].data && data[id].data[0]) {\n            let s0 = size_of(data[id].data[0])\n            bytes += s0 * data[id].data.length\n        }\n    }\n    return bytes\n}\n\n\n// Used to measure the size of dataset\nexport function size_of(object) {\n    var list = [], stack = [object], bytes = 0\n    while (stack.length) {\n        var value = stack.pop()\n        var type = typeof value\n        if (type === 'boolean') {\n            bytes += 4\n        } else if (type === 'string') {\n            bytes += value.length * 2\n        } else if (type === 'number') {\n            bytes += 8\n        } else if (type === 'object' &&\n            list.indexOf(value) === -1) {\n            list.push(value)\n            for(var i in value) {\n                stack.push(value[i])\n            }\n        }\n    }\n    return bytes\n}\n\n// Update onchart/offchart\nexport function update(data, val) {\n    const i = data.length - 1\n    const last = data[i]\n    if (!last || val[0] > last[0]) {\n        data.push(val)\n    } else {\n        data[i] = val\n    }\n}\n\nexport function now() {\n    return (new Date()).getTime()\n}\n","\n// Symbol (contains several samplers, e.g. high, low, close...)\n\nimport * as u from './script_utils.js'\nimport se from './script_engine.js'\nimport TS from './script_ts.js'\nimport Sampler from './sampler.js'\n\nconst OHLCV = ['open', 'high', 'low', 'close', 'vol']\n\nconst ARR = 0\nconst TSS = 1\nconst NUM = 2\n\nexport default class Sym {\n\n    constructor(data, params) {\n\n        this.id = params.id\n        this.tf = u.tf_from_str(params.tf)\n        this.format = params.format\n        this.aggtype = params.aggtype || 'ohlcv'\n        this.window = params.window\n        this.fillgaps = params.fillgaps\n        this.data = data\n        this.data_type = ARR\n        this.main = !!params.main\n        this.idx = this.data_idx()\n        this.tmap = {}\n\n        this.tf = this.tf || se.tf\n        if (this.main) this.tf = se.tf\n\n        // Create a bunch of OHLCV samplers for\n        // sparse data\n        if (this.aggtype === 'ohlcv') {\n            for (var id of OHLCV) {\n                this[id] = TS(`${this.id}_${id}`, [])\n                this[id].__fn__ = Sampler(id).bind(this[id])\n                this[id].__tf__ = this.tf\n            }\n        }\n\n        // Create regular TSs & just feed them with a\n        // data points from the dataset\n        // TODO: different TS configurations depending\n        // on this.format\n        if (this.aggtype === 'copy') {\n            for (var id of OHLCV) {\n                this[id] = TS(`${this.id}_${id}`, [])\n                this[id].__tf__ = this.tf\n            }\n            for (var i = 0; i < this.data.length; i++) {\n                this.tmap[this.data[i][0]] = i\n            }\n        }\n        // Custom agg function (value calculated for the\n        // current window)\n        if (typeof this.aggtype === 'function') {\n            this.close = TS(`${this.id}_close`, [])\n            this.close.__fn__ = this.aggtype\n            this.close.__tf__ = this.tf\n        }\n\n        if (this.main) {\n            if (!this.tf) throw 'Main tf should be defined'\n            se.custom_main = this\n            let t0 = this.data[0][0]\n            se.t = t0 - t0 % this.tf\n            this.update(null, se.t)\n\n            // First candle should be formed before any updates()\n            se.data.ohlcv.data.length = 0\n            se.data.ohlcv.data.push([\n                se.t,\n                this.open[0],\n                this.high[0],\n                this.low[0],\n                this.close[0],\n                this.vol[0]\n            ])\n        }\n\n    }\n\n    update(x, t) {\n        if(this.aggtype === 'ohlcv') {\n            return this.update_ohlcv(x, t)\n        } else if (this.aggtype === 'copy') {\n            return this.update_copy(x, t)\n        } else if (typeof this.aggtype === 'function') {\n            return this.update_custom(x, t)\n        }\n    }\n\n    update_ohlcv(x, t) {\n        // Timestamp of the target candle, can be\n        // current or the next (if we are sampling\n        // the main chart)\n        t = t || se.t\n        let idx = this.idx\n        switch (this.data_type) {\n            case ARR:\n                if (t > this.data[this.data.length-1][0]) return false\n                let t0 = this.window ? t - this.window + this.tf : t\n                let dt = t0 % this.tf\n                t0 -= dt\n                let i0 = u.nextt(this.data, t0)\n                if (i0 >= this.data.length) return false\n                let t1 = t + se.tf\n                // Flush volume before the next window,\n                // but not before a new candle\n                if (t < this.vol.__t0__ + this.tf) this.vol[0] = 0\n                let noevent = true\n                for(var i = i0; i < this.data.length; i++) {\n                    noevent = false\n                    let dp = this.data[i]\n                    if (dp[idx.time] >= t1) break\n                    this.open.__fn__(dp[idx.open], t)\n                    this.high.__fn__(dp[idx.high], t)\n                    this.low.__fn__(dp[idx.low], t)\n                    this.close.__fn__(dp[idx.close], t)\n                    this.vol.__fn__(dp[idx.vol], t)\n                }\n                if (noevent) {\n                    if (this.fillgaps === false && !this.main) return false\n                    let last = this.close[0]\n                    this.open.__fn__(last, t)\n                    this.high.__fn__(last, t)\n                    this.low.__fn__(last, t)\n                    this.close.__fn__(last, t)\n                    this.vol.__fn__(0, t)\n                }\n                break\n            case TSS:\n                // TODO: this\n                break\n            case NUM:\n                // TODO: this\n                break\n        }\n        return true\n    }\n\n    update_copy(x, t) {\n\n        t = t || se.t\n\n        // Assuming that we got an ohlcv dataset\n        let i = this.tmap[t]\n        let s = this.data[i]\n\n        let ts0 = this.__t0__\n        if (!ts0 || t >= ts0 + this.tf) {\n            for (var k = 0; k < 5; k++) {\n                let tsn = OHLCV[k]\n                this[tsn].unshift(undefined)\n            }\n            this.__t0__ = t - t % this.tf\n            let last = this.data.length - 1\n            if (this.__t0__ === this.data[last][0]) {\n                this.tmap[this.__t0__] = last\n                s = this.data[last]\n            }\n        }\n\n        if (s) {\n            for (var k = 0; k < 5; k++) {\n                let tsn = OHLCV[k]\n                this[tsn][0] = s[k + 1]\n            }\n        } else if (this.fillgaps) {\n            for (var k = 0; k < 5; k++) {\n                let tsn = OHLCV[k]\n                this[tsn][0] = this.close[1]\n            }\n        }\n    }\n\n    update_custom(x, t) {\n        t = t || se.t\n        let idx = this.idx\n        switch (this.data_type) {\n            case ARR:\n                if (!this.data.length) return false\n                if (t > this.data[this.data.length-1][0]) return false\n                let t0 = this.window ? t - this.window + this.tf : t\n                let dt = t0 % this.tf\n                t0 -= dt\n                let i0 = u.nextt(this.data, t0)\n                if (i0 >= this.data.length) return false\n                let t1 = t + se.tf\n\n                let sub = []\n                for(var i = i0; i < this.data.length; i++) {\n                    let dp = this.data[i]\n                    if (dp[idx.time] >= t1) break\n                    sub.push(dp)\n                }\n\n                if (sub.length || this.fillgaps === false) {\n                    var val = this.close.__fn__(sub) // TODO: prob a bug\n                } else if (this.fillgaps !== false) {\n                    val = this.close[0]\n                }\n                let ts0 = this.close.__t0__\n                if (!ts0 || t >= ts0 + this.tf) {\n                    this.close.unshift(val)\n                    this.close.__t0__ = t - t % this.tf\n                } else {\n                    this.close[0] = val\n                }\n                break\n            case TSS:\n                // TODO: this\n                break\n            case NUM:\n                // TODO: this\n                break\n        }\n        return true\n    }\n\n    // Calculates data indices from the format\n    data_idx() {\n        let idx = {}\n        switch(this.aggtype) {\n            case 'ohlcv':\n                // Trying to detect the format from the\n                // first data point\n                if (!this.format) {\n                    let x0 = this.data[0]\n                    if (!x0 || x0.length === 6) {\n                        this.format = 'time:open:high:low:close:vol'\n                    }\n                    else if (x0.length === 3) {\n                        this.format = 'time:open,high,low,close:vol'\n                    }\n                }\n                break\n            default:\n                this.format = 'time:close'\n                break\n        }\n        this.format.split(':').forEach((x, i) => {\n            if (!x.length) return\n            let list = x.split(',')\n            list.forEach(y => idx[y] = i)\n        })\n        return idx\n    }\n}\n\nexport { Sym, ARR, TSS, NUM }\n","\n// Parse non-default symbols, e.g. close1D, hlc3\n// & inject the corresponding TSs or samplers\n\nimport TS from './script_ts.js'\nimport Sampler from './sampler.js'\nimport se from './script_engine.js'\nimport * as u from './script_utils.js'\nimport ScriptStd from './script_std.js'\n\nconst SYMTF = /(open|high|low|close|vol)(\\d+)(\\w*)/gm\nconst FNSTD = /(a?tr|kcw?|dmi|sar|supertrend|wpr)(\\d+?\\w*)\\s*\\(/gm\nconst SYMSTD = /(?:hl2|hlc3|ohlc4)/gm\n\nexport default {\n\n    parse(s) {\n        let ss = s.src\n        let all = `${ss.init_src}\\n${ss.upd_src}\\n${ss.post_src}`\n\n        SYMTF.lastIndex = 0\n        FNSTD.lastIndex = 0\n        SYMSTD.lastIndex = 0\n\n        do {\n            var m = SYMTF.exec(all)\n            if (m) {\n                if (m[0] in se.tss) continue\n                let ts = se.tss[m[0]] = TS(m[0], [])\n                ts.__tf__ = u.tf_from_pair(m[2], m[3])\n                ts.__fn__ = Sampler(m[1], true).bind(ts)\n            }\n        } while (m)\n\n        do {\n            var m = SYMSTD.exec(all)\n            if (m) {\n                if (m[0] in se.tss) continue\n                this.parse_ts_sym(m[0])\n            }\n        } while (m)\n\n        do {\n            var m = FNSTD.exec(all)\n            if (m) {\n                let fn = m[1] + m[2]\n                let tf = m[2]\n                if (fn in se.std_plus) continue\n                switch(m[1]){\n                    case 'tr':\n                        this.deps(['high', 'low', 'close'], m[2])\n                        se.std_plus[fn] = function(fixnan = false, _id) {\n                            return this.tr(fixnan, _id, tf)\n                        }\n                        break\n                    case 'atr':\n                        this.deps(['high', 'low', 'close'], m[2])\n                        se.std_plus[fn] = function(len, _id) {\n                            return this.atr(len, _id, tf)\n                        }\n                        break\n                    case 'kc':\n                        this.deps(['high', 'low', 'close'], m[2])\n                        se.std_plus[fn] = function(src, len, mult,\n                            use_tr = true, _id) {\n                            return this.kc(src, len, mult, use_tr, _id, tf)\n                        }\n                        break\n                    case 'kcw':\n                        this.deps(['high', 'low', 'close'], m[2])\n                        se.std_plus[fn] = function(src, len, mult,\n                            use_tr = true, _id) {\n                            return this.kcw(src, len, mult, use_tr, _id, tf)\n                        }\n                        break\n                    case 'dmi':\n                        this.deps(['high', 'low', 'close'], m[2])\n                        se.std_plus[fn] = function(len, smooth, _id) {\n                            return this.dmi(len, smooth, _id, tf)\n                        }\n                        break\n                    case 'sar':\n                        this.deps(['high', 'low', 'close'], m[2])\n                        se.std_plus[fn] = function(start, inc, max, _id) {\n                            return this.sar(start, inc, max, _id, tf)\n                        }\n                        break\n                    case 'supertrend':\n                        this.deps(['high', 'low', 'close'], m[2])\n                        se.std_plus[fn] = function(factor, atrlen, _id) {\n                            return this.supertrend(factor, atrlen, _id, tf)\n                        }\n                        break\n                    case 'wpr':\n                        this.deps(['high', 'low', 'close'], m[2])\n                        se.std_plus[fn] = function(len, _id) {\n                            return this.wpr(len, _id, tf)\n                        }\n                        break\n                }\n            }\n        } while (m)\n    },\n\n    parse_ts_sym(sym, tf) {\n        switch(sym) {\n            // Timeseries\n            case 'hl2':\n                se.tss['hl2'] = TS('hl2', [])\n                se.tss['hl2'].__fn__ = () => {\n                    return (\n                        se.high[0] +\n                        se.low[0]) * 0.5\n                }\n                break\n            case 'hlc3':\n                se.tss['hlc3'] = TS('hlc3', [])\n                se.tss['hlc3'].__fn__ = () => {\n                    return (\n                        se.high[0] +\n                        se.low[0] +\n                        se.close[0]) / 3\n                }\n                break\n            case 'ohlc4':\n                se.tss['ohlc4'] = TS('ohlc4', [])\n                se.tss['ohlc4'].__fn__ = () => {\n                    return (\n                        se.open[0] +\n                        se.high[0] +\n                        se.low[0] +\n                        se.close[0]) * 0.25\n                }\n                break\n        }\n    },\n    deps(types, tf) {\n        for (var type of types) {\n            let sym = type + tf\n            if (sym in se.tss) continue\n            let ts = se.tss[sym] = TS(sym, [])\n            ts.__tf__ = u.tf_from_str(tf)\n            ts.__fn__ = Sampler(type, true).bind(ts)\n        }\n    }\n}\n","\r\nconst SECOND = 1000\r\nconst MINUTE = SECOND * 60\r\nconst MINUTE3 = MINUTE * 3\r\nconst MINUTE5 = MINUTE * 5\r\nconst MINUTE15 = MINUTE * 15\r\nconst MINUTE30 = MINUTE * 30\r\nconst HOUR = MINUTE * 60\r\nconst HOUR4 = HOUR * 4\r\nconst HOUR12 = HOUR * 12\r\nconst DAY = HOUR * 24\r\nconst WEEK = DAY * 7\r\nconst MONTH = WEEK * 4\r\nconst YEAR = DAY * 365\r\n\r\nconst MONTHMAP = [\r\n    \"Jan\", \"Feb\", \"Mar\", \"Apr\",\r\n    \"May\", \"Jun\",\"Jul\", \"Aug\",\r\n    \"Sep\", \"Oct\",\"Nov\", \"Dec\"\r\n]\r\n\r\n// Grid time steps\r\nconst TIMESCALES = [\r\n    YEAR * 10, YEAR * 5, YEAR * 3, YEAR * 2, YEAR,\r\n    MONTH * 6, MONTH * 4, MONTH * 3, MONTH * 2, MONTH,\r\n    DAY * 15, DAY * 10, DAY * 7, DAY * 5, DAY * 3, DAY * 2, DAY,\r\n    HOUR * 12, HOUR * 6, HOUR * 3, HOUR * 1.5, HOUR,\r\n    MINUTE30, MINUTE15, MINUTE * 10, MINUTE5, MINUTE * 2, MINUTE\r\n]\r\n\r\n// Grid $ steps\r\nconst $SCALES = [0.05, 0.1, 0.2, 0.25, 0.5, 0.8, 1, 2, 5]\r\n\r\nconst ChartConfig = {\r\n    SBMIN: 60,       // Minimal sidebar px\r\n    SBMAX: Infinity, // Max sidebar, px\r\n    TOOLBAR: 57,     // Toolbar width px\r\n    TB_ICON: 25,     // Toolbar icon size px\r\n    TB_ITEM_M: 6,    // Toolbar item margin px\r\n    TB_ICON_BRI: 1,  // Toolbar icon brightness\r\n    TB_ICON_HOLD: 420, // ms, wait to expand\r\n    TB_BORDER: 1,    // Toolbar border px\r\n    TB_B_STYLE: 'dotted', // Toolbar border style\r\n    TOOL_COLL: 7,    // Tool collision threshold\r\n    EXPAND: 0.15,    // %/100 of range\r\n    CANDLEW: 0.6,    // %/100 of step\r\n    GRIDX: 100,      // px\r\n    GRIDY: 47,       // px\r\n    BOTBAR: 28,      // px\r\n    PANHEIGHT: 22,   // px\r\n    DEFAULT_LEN: 50, // candles\r\n    MINIMUM_LEN: 5,  // candles,\r\n    MIN_ZOOM: 25,    // candles\r\n    MAX_ZOOM: 1000,  // candles,\r\n    VOLSCALE: 0.15,  // %/100 of height\r\n    UX_OPACITY: 0.9, // Ux background opacity\r\n    ZOOM_MODE: 'tv', // 'tv' or 'tl'\r\n    L_BTN_SIZE: 21,  // Legend Button size, px\r\n    L_BTN_MARGIN: '-6px 0 -6px 0', // css margin\r\n    SCROLL_WHEEL: 'prevent', // 'pass', 'click'\r\n}\r\n\r\nChartConfig.FONT =\r\n    `11px -apple-system,BlinkMacSystemFont,\r\n    Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,\r\n    Fira Sans,Droid Sans,Helvetica Neue,\r\n    sans-serif`\r\n\r\nconst IB_TF_WARN =\r\n    `When using IB mode you should specify ` +\r\n    `timeframe ('tf' filed in 'chart' object),` +\r\n    `otherwise you can get an unexpected behaviour`\r\n\r\nconst MAP_UNIT = {\r\n  \"1s\": SECOND,\r\n  \"5s\": SECOND * 5,\r\n  \"10s\": SECOND * 10,\r\n  \"20s\": SECOND * 20,\r\n  \"30s\": SECOND * 30,\r\n  \"1m\": MINUTE,\r\n  \"3m\": MINUTE3,\r\n  \"5m\": MINUTE5,\r\n  \"15m\": MINUTE15,\r\n  \"30m\": MINUTE30,\r\n  \"1H\": HOUR,\r\n  \"2H\": HOUR * 2,\r\n  \"3H\": HOUR * 3,\r\n  \"4H\": HOUR4,\r\n  \"12H\": HOUR12,\r\n  \"1D\": DAY,\r\n  \"1W\": WEEK,\r\n  \"1M\": MONTH,\r\n  \"1Y\": YEAR\r\n}\r\n\r\nexport default {\r\n    SECOND: SECOND,\r\n    MINUTE: MINUTE,\r\n    MINUTE5: MINUTE5,\r\n    MINUTE15: MINUTE15,\r\n    MINUTE30: MINUTE30,\r\n    HOUR: HOUR,\r\n    HOUR4: HOUR4,\r\n    DAY: DAY,\r\n    WEEK: WEEK,\r\n    MONTH: MONTH,\r\n    YEAR: YEAR,\r\n    MONTHMAP: MONTHMAP,\r\n    TIMESCALES: TIMESCALES,\r\n    $SCALES: $SCALES,\r\n    ChartConfig: ChartConfig,\r\n    map_unit: MAP_UNIT,\r\n    IB_TF_WARN\r\n}\r\n","/**\n * Simple linear regression\n *\n * @param {Array.<number>} data\n * @return {Function}\n */\nexport default function regression(data, len, offset) {\n\n    data = data.slice(0, len).reverse().map((x, i) => [i, x])\n\n    var sum_x = 0,\n        sum_y = 0,\n        sum_xy = 0,\n        sum_xx = 0,\n        count = 0,\n        m, b\n\n    // calculate sums\n    for (var i = 0, len = data.length; i < len; i++) {\n        if (!data[i]) return NaN\n        var point = data[i]\n        sum_x += point[0]\n        sum_y += point[1]\n        sum_xx += point[0] * point[0]\n        sum_xy += point[0] * point[1]\n        count++\n    }\n\n    // calculate slope (m) and y-intercept (b) for f(x) = m * x + b\n    m = (count * sum_xy - sum_x * sum_y) / (count * sum_xx - sum_x * sum_x)\n    b = (sum_y / count) - (m * sum_x) / count\n\n    return m * (data.length - 1 - offset) + b\n\n}\n","\nimport IndexedArray from 'arrayslicer'\nimport Const from './constants.js'\n\nexport default {\n\n    clamp(num, min, max) {\n        return num <= min ? min : num >= max ? max : num\n    },\n\n    add_zero(i) {\n        if (i < 10) {\n            i = \"0\" + i;\n        }\n        return i\n    },\n\n    // Start of the day (zero millisecond)\n    day_start(t) {\n        let start = new Date(t)\n        return start.setUTCHours(0,0,0,0)\n    },\n\n    // Start of the month\n    month_start(t) {\n        let date = new Date(t)\n        return Date.UTC(\n            date.getFullYear(),\n            date.getMonth(), 1\n        )\n    },\n\n    // Start of the year\n    year_start(t) {\n        return Date.UTC(new Date(t).getFullYear())\n    },\n\n    get_year(t) {\n        if (!t) return undefined\n        return new Date(t).getUTCFullYear()\n    },\n\n    get_month(t) {\n        if (!t) return undefined\n        return new Date(t).getUTCMonth()\n    },\n\n    // Nearest in array\n    nearest_a(x, array) {\n        let dist = Infinity\n        let val = null\n        let index = -1\n        for (var i = 0; i < array.length; i++) {\n            var xi = array[i]\n            if (Math.abs(xi - x) < dist) {\n                dist = Math.abs(xi - x)\n                val = xi\n                index = i\n            }\n        }\n        return [index, val]\n    },\n\n    round(num, decimals = 8) {\n        return parseFloat(num.toFixed(decimals))\n    },\n\n    // Strip? No, it's ugly floats in js\n    strip(number) {\n        return parseFloat(\n            parseFloat(number).toPrecision(12)\n        )\n    },\n\n    get_day(t) {\n        return t ? new Date(t).getDate() : null\n    },\n\n    // Update array keeping the same reference\n    overwrite(arr, new_arr) {\n        arr.splice(0, arr.length, ...new_arr)\n    },\n\n    // Copy layout in reactive way\n    copy_layout(obj, new_obj) {\n        for (var k in obj) {\n            if (Array.isArray(obj[k])) {\n                // (some offchart indicators are added/removed)\n                // we need to update layout in a reactive way\n                if (obj[k].length !== new_obj[k].length) {\n                    this.overwrite(obj[k], new_obj[k])\n                    continue\n                }\n                for (var m in obj[k]) {\n                    Object.assign(obj[k][m], new_obj[k][m])\n                }\n            } else {\n                Object.assign(obj[k], new_obj[k])\n            }\n        }\n    },\n\n    // Detects candles interval\n    detect_interval(ohlcv) {\n        let len = Math.min(ohlcv.length - 1, 99)\n        let min = Infinity\n        ohlcv.slice(0, len).forEach((x, i) => {\n            let d = ohlcv[i+1][0] - x[0]\n            if (d === d && d < min) min = d\n        })\n        // This saves monthly chart from being awkward\n        if (min >= Const.MONTH && min <= Const.DAY * 30) {\n            return Const.DAY * 31\n        }\n        return min\n    },\n\n    // Gets numberic part of overlay id (e.g 'EMA_1' = > 1)\n    get_num_id(id) {\n        return parseInt(id.split('_').pop())\n    },\n\n    // Fast filter. Really fast, like 10X\n    fast_filter(arr, t1, t2) {\n        if (!arr.length) return [arr, undefined]\n        try {\n            let ia = new IndexedArray(arr, \"0\")\n            let res = ia.getRange(t1, t2)\n            let i0 = ia.valpos[t1].next\n            return [res, i0]\n        } catch(e) {\n            // Something wrong with fancy slice lib\n            // Fast fix: fallback to filter\n            return [arr.filter(x =>\n                x[0] >= t1 && x[0] <= t2\n            ), 0]\n        }\n    },\n\n    // Fast filter (index-based)\n    fast_filter_i(arr, t1, t2) {\n        if (!arr.length) return [arr, undefined]\n        let i1 =  Math.floor(t1)\n        if (i1 < 0) i1 = 0\n        let i2 =  Math.floor(t2 + 1)\n        let res = arr.slice(i1, i2)\n        return [res, i1]\n    },\n\n    // Nearest indexes (left and right)\n    fast_nearest(arr, t1) {\n        let ia = new IndexedArray(arr, \"0\")\n        ia.fetch(t1)\n        return [ia.nextlow, ia.nexthigh]\n    },\n\n    now() { return (new Date()).getTime() },\n\n    pause(delay) {\n        return new Promise((rs, rj) => setTimeout(rs, delay))\n    },\n\n    // Limit crazy wheel delta values\n    smart_wheel(delta) {\n        let abs = Math.abs(delta)\n        if (abs > 500) {\n            return (200 + Math.log(abs)) * Math.sign(delta)\n        }\n        return delta\n    },\n\n    // Parse the original mouse event to find deltaX\n    get_deltaX(event) {\n        return event.originalEvent.deltaX / 12\n    },\n\n    // Parse the original mouse event to find deltaY\n    get_deltaY(event) {\n        return event.originalEvent.deltaY / 12\n    },\n\n    // Apply opacity to a hex color\n    apply_opacity(c, op) {\n        if (c.length === 7) {\n            let n = Math.floor(op * 255)\n            n = this.clamp(n, 0, 255)\n            c += n.toString(16)\n        }\n        return c\n    },\n\n    // Parse timeframe or return value in ms\n    parse_tf(smth) {\n        if (typeof smth === 'string') {\n            return Const.map_unit[smth]\n        } else {\n            return smth\n        }\n    },\n\n    // Detect index shift between the main data sub\n    // and the overlay's sub (for IB-mode)\n    index_shift(sub, data) {\n\n        // Find the second timestamp (by value)\n        if (!data.length) return 0\n        let first = data[0][0]\n        let second\n\n        for (var i = 1; i < data.length; i++) {\n            if (data[i][0] !== first) {\n                second = data[i][0]\n                break\n            }\n        }\n\n        for (var j = 0; j < sub.length; j++) {\n            if (sub[j][0] === second) {\n                return j - i\n            }\n        }\n\n        return 0\n    },\n\n    // Fallback fix for Brave browser\n    // https://github.com/brave/brave-browser/issues/1738\n    measureText(ctx, text, tv_id) {\n        let m = ctx.measureTextOrg(text)\n        if (m.width === 0) {\n            const doc = document\n            const id = 'tvjs-measure-text'\n            let el = doc.getElementById(id)\n            if (!el) {\n                let base = doc.getElementById(tv_id)\n                el = doc.createElement(\"div\")\n                el.id = id\n                el.style.position = 'absolute'\n                el.style.top = '-1000px'\n                base.appendChild(el)\n            }\n            if(ctx.font) el.style.font = ctx.font\n            el.innerText = text.replace(/ /g, '.');\n            return { width: el.offsetWidth }\n        } else {\n            return m\n        }\n    },\n\n    uuid(temp = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx') {\n        return temp\n            .replace(/[xy]/g, c => {\n            var r = Math.random() * 16 | 0, v = c == 'x' ?\n                r :\n                (r & 0x3 | 0x8)\n            return v.toString(16)\n        })\n    },\n\n    uuid2() {\n        return this.uuid('xxxxxxxxxxxx')\n    },\n\n    // Delayed warning, f = condition lambda fn\n    warn(f, text, delay = 0) {\n        setTimeout(() => {\n            if (f()) console.warn(text)\n        }, delay)\n    },\n\n    // Checks if script props updated\n    // (and not style settings or something else)\n    is_scr_props_upd(n, prev) {\n        let p = prev.find(x => x.v.$uuid === n.v.$uuid)\n        if (!p) return false\n\n        let props = n.p.settings.$props\n        if (!props) return false\n\n        return props.some(x => n.v[x] !== p.v[x])\n    },\n\n    // Checks if it's time to make a script update\n    // (based on execInterval in ms)\n    delayed_exec(v) {\n        if (!v.script || !v.script.execInterval)\n            return true\n        let t = this.now()\n        let dt = v.script.execInterval\n        if (!v.settings.$last_exec ||\n            t > v.settings.$last_exec + dt) {\n            v.settings.$last_exec = t\n            return true\n        }\n        return false\n    },\n\n    // Format names such 'RSI, $length', where\n    // length - is one of the settings\n    format_name(ov) {\n        if (!ov.name) return undefined\n\n        let name = ov.name\n\n        for (var k in ov.settings || {}) {\n            let val = ov.settings[k]\n            let reg = new RegExp(`\\\\$${k}`, 'g')\n            name = name.replace(reg, val)\n        }\n\n        return name\n    },\n\n    // Default cursor mode\n    xmode() {\n        return this.is_mobile ? 'explore' : 'default'\n    },\n\n    default_prevented(event) {\n        if (event.original) {\n            return event.original.defaultPrevented\n        }\n        return event.defaultPrevented\n    },\n\n    // WTF with modern web development\n    is_mobile: (w => 'onorientationchange' in w &&\n       (!!navigator.maxTouchPoints ||\n        !!navigator.msMaxTouchPoints ||\n        ('ontouchstart' in w ||\n        (w.DocumentTouch &&\n        document instanceof w.DocumentTouch))))\n        (typeof window !== 'undefined' ? window : {})\n\n}\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function define(obj, key, value) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n    return obj[key];\n  }\n  try {\n    // IE 8 has a broken Object.defineProperty that only works on DOM objects.\n    define({}, \"\");\n  } catch (err) {\n    define = function(obj, key, value) {\n      return obj[key] = value;\n    };\n  }\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunction.displayName = define(\n    GeneratorFunctionPrototype,\n    toStringTagSymbol,\n    \"GeneratorFunction\"\n  );\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      define(prototype, method, function(arg) {\n        return this._invoke(method, arg);\n      });\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      define(genFun, toStringTagSymbol, \"GeneratorFunction\");\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  define(Gp, toStringTagSymbol, \"Generator\");\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","\n// Web-worker\n\nimport se from './script_engine.js'\nimport Utils from '../stuff/utils.js'\nimport * as u from './script_utils.js'\nimport { DatasetWW } from './dataset.js'\n\nvar data_requested = false\n\n// DC => WW\n\nself.onmessage = async e => {\n    //console.log('Worker got:', e.data.type)\n    switch(e.data.type) {\n\n        case 'update-dc-settings':\n\n            se.sett = e.data.data\n\n            break\n\n        case 'exec-script':\n\n            var req = se.data_required(e.data.data.s)\n            if (req && !data_requested) {\n                data_requested = true\n                self.postMessage({\n                    type: 'request-data', data: req\n                })\n            }\n            se.tf = u.tf_from_str(e.data.data.tf)\n            se.range = e.data.data.range\n            se.queue.push(e.data.data.s)\n            se.exec_all()\n\n            break\n\n        case 'exec-all-scripts':\n\n            var req = se.data_required(e.data.data.s)\n            if (req && !data_requested) {\n                data_requested = true\n                self.postMessage({\n                    type: 'request-data', data: req\n                })\n            }\n\n            se.tf = u.tf_from_str(e.data.data.tf)\n            se.range = e.data.data.range\n            se.exec_all()\n\n            break\n\n        case 'upload-data':\n            self.postMessage({ type: 'data-uploaded' })\n\n            await Utils.pause(1)\n\n            for (var id in e.data.data) {\n                let data = e.data.data[id]\n                se.data[id] = new DatasetWW(id, data)\n            }\n\n            se.recalc_size()\n            data_requested = false\n            se.exec_all()\n\n            break\n\n        case 'upload-module':\n\n            let lib = u.make_module_lib(e.data.data)\n            se.mods[e.data.data.id] = new (\n                new Function(\n                    'mod', 'se', 'lib',\n                    u.f_body(e.data.data.main)\n                )\n            )(e.data.data.id, se, lib)\n\n            break\n\n        case 'module-event':\n            // TODO: this\n            break\n\n        case 'update-data':\n\n            DatasetWW.update_all(se, e.data.data)\n\n            if (e.data.data.ohlcv) {\n                se.update(e.data.data.ohlcv)\n            }\n\n            break\n\n        case 'get-dataset':\n\n            self.postMessage({\n                id: e.data.id,\n                data: se.data[e.data.data]\n            })\n\n            break\n\n        case 'dataset-op':\n\n            await Utils.pause(1)\n\n            if (e.data.data.id in se.data) {\n                se.data[e.data.data.id].op(se, e.data.data)\n            }\n\n            if (e.data.data.exec) se.exec_all()\n\n            break\n\n        case 'update-ov-settings':\n\n            se.tf = u.tf_from_str(e.data.data.tf)\n            se.range = e.data.data.range\n            se.exec_sel(e.data.data.delta)\n\n            break\n\n        case 'send-meta-info':\n\n            se.tf = u.tf_from_str(e.data.data.tf)\n            se.range = e.data.data.range\n\n            break\n\n        case 'remove-scripts':\n\n            se.remove_scripts(e.data.data)\n\n            break\n    }\n\n}\n\n// WW => DC\n\nse.send = (type, data) => {\n\n    switch(type) {\n\n        case 'overlay-data':\n        case 'overlay-update':\n        case 'engine-state':\n        case 'modify-overlay':\n        case 'module-data':\n        case 'script-signal':\n\n            self.postMessage({type, data})\n\n            break\n\n    }\n\n}\n"],"sourceRoot":""}